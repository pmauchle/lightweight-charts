/*!
 * @license
 * TradingView Lightweight Charts v4.0.0-dev+202203090750
 * Copyright (c) 2022 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */
!function(){"use strict";var t,i;function s(t,i){const s={0:[],1:[t.lineWidth,t.lineWidth],2:[2*t.lineWidth,2*t.lineWidth],3:[6*t.lineWidth,6*t.lineWidth],4:[t.lineWidth,4*t.lineWidth]}[i];t.setLineDash(s)}function n(t,i,s,n){t.beginPath();const e=t.lineWidth%2?.5:0;t.moveTo(s,i+e),t.lineTo(n,i+e),t.stroke()}function e(t,i){if(!t)throw new Error("Assertion failed"+(i?": "+i:""))}function r(t){if(void 0===t)throw new Error("Value is undefined");return t}function h(t){if(null===t)throw new Error("Value is null");return t}function l(t){return h(r(t))}!function(t){t[t.Simple=0]="Simple",t[t.WithSteps=1]="WithSteps",t[t.Curved=2]="Curved"}(t||(t={})),function(t){t[t.Solid=0]="Solid",t[t.Dotted=1]="Dotted",t[t.Dashed=2]="Dashed",t[t.LargeDashed=3]="LargeDashed",t[t.SparseDotted=4]="SparseDotted"}(i||(i={}));const a={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function o(t){return t<0?0:t>255?255:Math.round(t)||0}function _(t){return t<=0||t>0?t<0?0:t>1?1:Math.round(1e4*t)/1e4:0}const u=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,c=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,d=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,f=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/;function p(t){(t=t.toLowerCase())in a&&(t=a[t]);{const i=f.exec(t)||d.exec(t);if(i)return[o(parseInt(i[1],10)),o(parseInt(i[2],10)),o(parseInt(i[3],10)),_(i.length<5?1:parseFloat(i[4]))]}{const i=c.exec(t);if(i)return[o(parseInt(i[1],16)),o(parseInt(i[2],16)),o(parseInt(i[3],16)),1]}{const i=u.exec(t);if(i)return[o(17*parseInt(i[1],16)),o(17*parseInt(i[2],16)),o(17*parseInt(i[3],16)),1]}throw new Error(`Cannot parse color: ${t}`)}function v(t){const i=p(t);return{t:`rgb(${i[0]}, ${i[1]}, ${i[2]})`,i:(s=i,.199*s[0]+.687*s[1]+.114*s[2]>160?"black":"white")};var s}class m{constructor(){this.h=[]}l(t,i,s){const n={o:t,_:i,u:!0===s};this.h.push(n)}p(t){const i=this.h.findIndex((i=>t===i.o));i>-1&&this.h.splice(i,1)}v(t){this.h=this.h.filter((i=>i._!==t))}m(t,i){const s=[...this.h];this.h=this.h.filter((t=>!t.u)),s.forEach((s=>s.o(t,i)))}g(){return this.h.length>0}M(){this.h=[]}}function w(t,...i){for(const s of i)for(const i in s)void 0!==s[i]&&("object"!=typeof s[i]||void 0===t[i]?t[i]=s[i]:w(t[i],s[i]));return t}function g(t){return"number"==typeof t&&isFinite(t)}function b(t){return"number"==typeof t&&t%1==0}function M(t){return"string"==typeof t}function S(t){return"boolean"==typeof t}function y(t){const i=t;if(!i||"object"!=typeof i)return i;let s,n,e;for(n in s=Array.isArray(i)?[]:{},i)i.hasOwnProperty(n)&&(e=i[n],s[n]=e&&"object"==typeof e?y(e):e);return s}function k(t){return null!==t}function x(t){return null===t?void 0:t}const T="'Trebuchet MS', Roboto, Ubuntu, sans-serif";function C(t,i,s){return void 0===i&&(i=T),`${s=void 0!==s?`${s} `:""}${t}px ${i}`}class D{constructor(t){this.S={k:1,T:4,C:NaN,D:"",P:"",O:"",N:0,R:0,A:0,L:0,I:0},this.B=t}V(){const t=this.S,i=this.F(),s=this.W();return t.C===i&&t.P===s||(t.C=i,t.P=s,t.D=C(i,s),t.L=Math.floor(i/3.5),t.N=t.L,t.R=Math.max(Math.ceil(i/2-t.T/2),0),t.A=Math.ceil(i/2+t.T/2),t.I=Math.round(i/10)),t.O=this.j(),this.S}j(){return this.B.V().layout.textColor}F(){return this.B.V().layout.fontSize}W(){return this.B.V().layout.fontFamily}}class P{constructor(){this.$=[]}H(t){this.$=t}U(t,i,s,n){this.$.forEach((e=>{t.save(),e.U(t,i,s,n),t.restore()}))}}class O{U(t,i,s,n){t.save(),t.scale(i,i),this.q(t,s,n),t.restore()}Y(t,i,s,n){t.save(),t.scale(i,i),this.X(t,s,n),t.restore()}X(t,i,s){}}class N extends O{constructor(){super(...arguments),this.K=null}Z(t){this.K=t}q(t){if(null===this.K||null===this.K.G)return;const i=this.K.G,s=this.K,n=n=>{t.beginPath();for(let e=i.to-1;e>=i.from;--e){const i=s.J[e];t.moveTo(i.tt,i.it),t.arc(i.tt,i.it,n,0,2*Math.PI)}t.fill()};t.fillStyle=s.st,n(s.nt+2),t.fillStyle=s.et,n(s.nt)}}function R(){return{J:[{tt:0,it:0,rt:0,ht:0}],et:"",st:"",nt:0,G:null}}const E={from:0,to:1};class A{constructor(t,i){this.lt=new P,this.ot=[],this._t=[],this.ut=!0,this.B=t,this.ct=i,this.lt.H(this.ot)}dt(t){const i=this.B.ft();i.length!==this.ot.length&&(this._t=i.map(R),this.ot=this._t.map((t=>{const i=new N;return i.Z(t),i})),this.lt.H(this.ot)),this.ut=!0}vt(t,i,s){return this.ut&&(this.wt(t),this.ut=!1),this.lt}wt(t){const i=this.B.ft(),s=this.ct.gt(),n=this.B.bt();i.forEach(((i,e)=>{var r;const l=this._t[e],a=i.Mt(s);if(null===a||!i.St())return void(l.G=null);const o=h(i.yt());l.et=a.kt,l.nt=a.nt,l.J[0].ht=a.ht,l.J[0].it=i.Tt().xt(a.ht,o.Ct),l.st=null!==(r=a.Dt)&&void 0!==r?r:this.B.Pt(l.J[0].it/t),l.J[0].rt=s,l.J[0].tt=n.Ot(s),l.G=E}))}}class L{constructor(t){this.Nt=t}U(t,i,e,r){if(null===this.Nt)return;const h=this.Nt.Rt.St,l=this.Nt.Et.St;if(!h&&!l)return;t.save();const a=Math.round(this.Nt.tt*i),o=Math.round(this.Nt.it*i),_=Math.ceil(this.Nt.At*i),u=Math.ceil(this.Nt.Lt*i);t.lineCap="butt",h&&a>=0&&(t.lineWidth=Math.floor(this.Nt.Rt.It*i),t.strokeStyle=this.Nt.Rt.O,t.fillStyle=this.Nt.Rt.O,s(t,this.Nt.Rt.Bt),function(t,i,s,n){t.beginPath();const e=t.lineWidth%2?.5:0;t.moveTo(i+e,s),t.lineTo(i+e,n),t.stroke()}(t,a,0,u)),l&&o>=0&&(t.lineWidth=Math.floor(this.Nt.Et.It*i),t.strokeStyle=this.Nt.Et.O,t.fillStyle=this.Nt.Et.O,s(t,this.Nt.Et.Bt),n(t,o,0,_)),t.restore()}}class I{constructor(t){this.ut=!0,this.Vt={Rt:{It:1,Bt:0,O:"",St:!1},Et:{It:1,Bt:0,O:"",St:!1},At:0,Lt:0,tt:0,it:0},this.Ft=new L(this.Vt),this.zt=t}dt(){this.ut=!0}vt(t,i){return this.ut&&(this.wt(),this.ut=!1),this.Ft}wt(){const t=this.zt.St(),i=h(this.zt.Wt()),s=i.jt().V().crosshair,n=this.Vt;n.Et.St=t&&this.zt.$t(i),n.Rt.St=t&&this.zt.Ht(),n.Et.It=s.horzLine.width,n.Et.Bt=s.horzLine.style,n.Et.O=s.horzLine.color,n.Rt.It=s.vertLine.width,n.Rt.Bt=s.vertLine.style,n.Rt.O=s.vertLine.color,n.At=i.Ut(),n.Lt=i.qt(),n.tt=this.zt.Yt(),n.it=this.zt.Xt()}}function B(t,i,s,n,e,r){t.fillRect(i+r,s,n-2*r,r),t.fillRect(i+r,s+e-r,n-2*r,r),t.fillRect(i,s,r,e),t.fillRect(i+n-r,s,r,e)}function V(t,i,s){t.save(),t.scale(i,i),s(),t.restore()}function F(t,i,s,n,e,r){t.save(),t.globalCompositeOperation="copy",t.fillStyle=r,t.fillRect(i,s,n,e),t.restore()}function z(t,i,s,n,e,r,h){t.save(),t.globalCompositeOperation="copy";const l=t.createLinearGradient(0,0,0,e);l.addColorStop(0,r),l.addColorStop(1,h),t.fillStyle=l,t.fillRect(i,s,n,e),t.restore()}class W{constructor(t,i){this.Z(t,i)}Z(t,i){this.Nt=t,this.Kt=i}U(t,i,s,n,e,r){if(!this.Nt.St)return;t.font=i.D;const h=this.Nt.Zt||!this.Nt.Gt?i.T:0,l=i.k,a=i.L,o=i.N,_=i.R,u=i.A,c=this.Nt.Jt,d=Math.ceil(s.Qt(t,c)),f=i.I,p=i.C+a+o,v=Math.ceil(.5*p),m=l+d+_+u+h;let w=this.Kt.ti;this.Kt.ii&&(w=this.Kt.ii),w=Math.round(w);const g=w-v,b=g+p,M="right"===e,S=M?n:0,y=Math.ceil(n*r);let k,x,T=S;if(t.fillStyle=this.Kt.t,t.lineWidth=1,t.lineCap="butt",c){M?(T=S-m,k=S-h,x=T+u):(T=S+m,k=S+h,x=S+l+h+_);const i=Math.max(1,Math.floor(r)),s=Math.max(1,Math.floor(l*r)),n=M?y:0,e=Math.round(g*r),a=Math.round(T*r),d=Math.round(w*r)-Math.floor(.5*r),p=d+i+(d-e),v=Math.round(k*r);t.save(),t.beginPath(),t.moveTo(n,e),t.lineTo(a,e),t.lineTo(a,p),t.lineTo(n,p),t.fill(),t.fillStyle=this.Nt.Dt,t.fillRect(M?y-s:0,e,s,p-e),this.Nt.Zt&&(t.fillStyle=this.Kt.O,t.fillRect(n,d,v-n,i)),t.textAlign="left",t.fillStyle=this.Kt.O,V(t,r,(()=>{t.fillText(c,x,b-o-f)})),t.restore()}}qt(t,i){return this.Nt.St?t.C+t.L+t.N:0}}class j{constructor(t){this.si={ti:0,O:"#FFF",t:"#000"},this.ni={Jt:"",St:!1,Zt:!0,Gt:!1,Dt:""},this.ei={Jt:"",St:!1,Zt:!1,Gt:!0,Dt:""},this.ut=!0,this.ri=new(t||W)(this.ni,this.si),this.hi=new(t||W)(this.ei,this.si)}Jt(){return this.li(),this.ni.Jt}ti(){return this.li(),this.si.ti}dt(){this.ut=!0}qt(t,i=!1){return Math.max(this.ri.qt(t,i),this.hi.qt(t,i))}ai(){return this.si.ii||0}oi(t){this.si.ii=t}_i(){return this.li(),this.ni.St||this.ei.St}ui(){return this.li(),this.ni.St}vt(t){return this.li(),this.ni.Zt=this.ni.Zt&&t.V().drawTicks,this.ei.Zt=this.ei.Zt&&t.V().drawTicks,this.ri.Z(this.ni,this.si),this.hi.Z(this.ei,this.si),this.ri}ci(){return this.li(),this.ri.Z(this.ni,this.si),this.hi.Z(this.ei,this.si),this.hi}li(){this.ut&&(this.ni.Zt=!0,this.ei.Zt=!1,this.di(this.ni,this.ei,this.si))}}class $ extends j{constructor(t,i,s){super(),this.zt=t,this.fi=i,this.pi=s}di(t,i,s){t.St=!1;const n=this.zt.V().horzLine;if(!n.labelVisible)return;const e=this.fi.yt();if(!this.zt.St()||this.fi.vi()||null===e)return;const r=v(n.labelBackgroundColor);s.t=r.t,s.O=r.i;const h=this.pi(this.fi);s.ti=h.ti,t.Jt=this.fi.mi(h.ht,e),t.St=!0}}const H=/[1-9]/g;class U{constructor(){this.Nt=null}Z(t){this.Nt=t}U(t,i,s){if(null===this.Nt||!1===this.Nt.St||0===this.Nt.Jt.length)return;t.font=i.D;const n=Math.round(i.wi.Qt(t,this.Nt.Jt,H));if(n<=0)return;t.save();const e=i.gi,r=n+2*e,l=r/2,a=this.Nt.Ut;let o=this.Nt.ti,_=Math.floor(o-l)+.5;_<0?(o+=Math.abs(0-_),_=Math.floor(o-l)+.5):_+r>a&&(o-=Math.abs(a-(_+r)),_=Math.floor(o-l)+.5);const u=_+r,c=0+i.k+i.L+i.C+i.N;t.fillStyle=this.Nt.t;const d=Math.round(_*s),f=Math.round(0*s),p=Math.round(u*s),v=Math.round(c*s);t.fillRect(d,f,p-d,v-f);const m=Math.round(this.Nt.ti*s),w=f,g=Math.round((w+i.k+i.T)*s);t.fillStyle=this.Nt.O;const b=Math.max(1,Math.floor(s)),M=Math.floor(.5*s);t.fillRect(m-M,w,b,g-w);const S=c-i.I-i.N;t.textAlign="left",t.fillStyle=this.Nt.O,V(t,s,(()=>{t.fillText(h(this.Nt).Jt,_+e,S)})),t.restore()}}class q{constructor(t,i,s){this.ut=!0,this.Ft=new U,this.Vt={St:!1,t:"#4c525e",O:"white",Jt:"",Ut:0,ti:NaN},this.ct=t,this.bi=i,this.pi=s}dt(){this.ut=!0}vt(){return this.ut&&(this.wt(),this.ut=!1),this.Ft.Z(this.Vt),this.Ft}wt(){const t=this.Vt;t.St=!1;const i=this.ct.V().vertLine;if(!i.labelVisible)return;const s=this.bi.bt();if(s.vi())return;t.Ut=s.Ut();const n=this.pi();if(!n.rt)return;t.ti=n.ti;const e=s.Mi(this.ct.gt());t.Jt=s.Si(h(e)),t.St=!0;const r=v(i.labelBackgroundColor);t.t=r.t,t.O=r.i}}class Y{constructor(){this.yi=null,this.ki=0}xi(){return this.ki}Ti(t){this.ki=t}Tt(){return this.yi}Ci(t){this.yi=t}Di(){return[]}St(){return!0}}var X;!function(t){t[t.Normal=0]="Normal",t[t.Magnet=1]="Magnet"}(X||(X={}));class K extends Y{constructor(t,i){super(),this.Pi=null,this.Oi=NaN,this.Ni=0,this.Ri=!0,this.Ei=new Map,this.Ai=!1,this.Li=NaN,this.Ii=NaN,this.Bi=NaN,this.Vi=NaN,this.bi=t,this.Fi=i,this.zi=new A(t,this);this.Wi=((t,i)=>s=>{const n=i(),e=t();if(s===h(this.Pi).ji())return{ht:e,ti:n};{const t=h(s.yt());return{ht:s.$i(n,t),ti:n}}})((()=>this.Oi),(()=>this.Ii));const s=((t,i)=>()=>({rt:this.bi.bt().Hi(t()),ti:i()}))((()=>this.Ni),(()=>this.Yt()));this.Ui=new q(this,t,s),this.qi=new I(this)}V(){return this.Fi}Yi(t,i){this.Bi=t,this.Vi=i}Xi(){this.Bi=NaN,this.Vi=NaN}Ki(){return this.Bi}Zi(){return this.Vi}Gi(t,i,s){this.Ai||(this.Ai=!0),this.Ri=!0,this.Ji(t,i,s)}gt(){return this.Ni}Yt(){return this.Li}Xt(){return this.Ii}St(){return this.Ri}Qi(){this.Ri=!1,this.ts(),this.Oi=NaN,this.Li=NaN,this.Ii=NaN,this.Pi=null,this.Xi()}ss(t){return null!==this.Pi?[this.qi,this.zi]:[]}$t(t){return t===this.Pi&&this.Fi.horzLine.visible}Ht(){return this.Fi.vertLine.visible}ns(t,i){this.Ri&&this.Pi===t||this.Ei.clear();const s=[];return this.Pi===t&&s.push(this.es(this.Ei,i,this.Wi)),s}Di(){return this.Ri?[this.Ui]:[]}Wt(){return this.Pi}rs(){this.qi.dt(),this.Ei.forEach((t=>t.dt())),this.Ui.dt(),this.zi.dt()}hs(t){return t&&!t.ji().vi()?t.ji():null}Ji(t,i,s){this.ls(t,i,s)&&this.rs()}ls(t,i,s){const n=this.Li,e=this.Ii,r=this.Oi,h=this.Ni,l=this.Pi,a=this.hs(s);this.Ni=t,this.Li=isNaN(t)?NaN:this.bi.bt().Ot(t),this.Pi=s;const o=null!==a?a.yt():null;return null!==a&&null!==o?(this.Oi=i,this.Ii=a.xt(i,o)):(this.Oi=NaN,this.Ii=NaN),n!==this.Li||e!==this.Ii||h!==this.Ni||r!==this.Oi||l!==this.Pi}ts(){const t=this.bi.ft().map((t=>t._s().os())).filter(k),i=0===t.length?null:Math.max(...t);this.Ni=null!==i?i:NaN}es(t,i,s){let n=t.get(i);return void 0===n&&(n=new $(this,i,s),t.set(i,n)),n}}function Z(t){return"left"===t||"right"===t}class G{constructor(t){this.us=new Map,this.cs=[],this.ds=t}fs(t,i){const s=function(t,i){return void 0===t?i:{ps:Math.max(t.ps,i.ps),vs:t.vs||i.vs}}(this.us.get(t),i);this.us.set(t,s)}ws(){return this.ds}gs(t){const i=this.us.get(t);return void 0===i?{ps:this.ds}:{ps:Math.max(this.ds,i.ps),vs:i.vs}}bs(){this.cs=[{Ms:0}]}Ss(t){this.cs=[{Ms:1,Ct:t}]}ys(){this.cs=[{Ms:4}]}ks(t){this.cs.push({Ms:2,Ct:t})}xs(t){this.cs.push({Ms:3,Ct:t})}Ts(){return this.cs}Cs(t){for(const i of t.cs)this.Ds(i);this.ds=Math.max(this.ds,t.ds),t.us.forEach(((t,i)=>{this.fs(i,t)}))}Ds(t){switch(t.Ms){case 0:this.bs();break;case 1:this.Ss(t.Ct);break;case 2:this.ks(t.Ct);break;case 3:this.xs(t.Ct);break;case 4:this.ys()}}}const J=".";function Q(t,i){if(!g(t))return"n/a";if(!b(i))throw new TypeError("invalid length");if(i<0||i>16)throw new TypeError("invalid length");if(0===i)return t.toString();return("0000000000000000"+t.toString()).slice(-i)}class tt{constructor(t,i){if(i||(i=1),g(t)&&b(t)||(t=100),t<0)throw new TypeError("invalid base");this.fi=t,this.Ps=i,this.Os()}format(t){const i=t<0?"−":"";return t=Math.abs(t),i+this.Ns(t)}Os(){if(this.Rs=0,this.fi>0&&this.Ps>0){let t=this.fi;for(;t>1;)t/=10,this.Rs++}}Ns(t){const i=this.fi/this.Ps;let s=Math.floor(t),n="";const e=void 0!==this.Rs?this.Rs:NaN;if(i>1){let r=+(Math.round(t*i)-s*i).toFixed(this.Rs);r>=i&&(r-=i,s+=1),n=J+Q(+r.toFixed(this.Rs)*this.Ps,e)}else s=Math.round(s*i)/i,e>0&&(n=J+Q(0,e));return s.toFixed(0)+n}}class it extends tt{constructor(t=100){super(t)}format(t){return`${super.format(t)}%`}}class st{constructor(t){this.Es=t}format(t){let i="";return t<0&&(i="-",t=-t),t<995?i+this.As(t):t<999995?i+this.As(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),i+this.As(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),i+this.As(t/1e9)+"B")}As(t){let i;const s=Math.pow(10,this.Es);return i=(t=Math.round(t*s)/s)>=1e-15&&t<1?t.toFixed(this.Es).replace(/\.?0+$/,""):String(t),i.replace(/(\.[1-9]*)0+$/,((t,i)=>i))}}function nt(t,i,s,n){if(0===i.length)return;const e=i[n.from].tt,r=i[n.from].it;t.moveTo(e,r);for(let e=n.from+1;e<n.to;++e){const n=i[e];switch(s){case 0:t.lineTo(n.tt,n.it);break;case 1:t.lineTo(n.tt,i[e-1].it),t.lineTo(n.tt,n.it);break;case 2:{const[s,r]=ht(i,e-1,e);t.bezierCurveTo(s.tt,s.it,r.tt,r.it,n.tt,n.it);break}}}}function et(t,i){return{tt:t.tt-i.tt,it:t.it-i.it}}function rt(t,i){return{tt:t.tt/i,it:t.it/i}}function ht(t,i,s){const n=Math.max(0,i-1),e=Math.min(t.length-1,s+1);var r,h;return[(r=t[i],h=rt(et(t[s],t[n]),6),{tt:r.tt+h.tt,it:r.it+h.it}),et(t[s],rt(et(t[e],t[i]),6))]}class lt extends O{constructor(){super(...arguments),this.K=null}Z(t){this.K=t}q(t){if(null!==this.K&&0!==this.K.J.length&&null!==this.K.G){if(t.lineCap="butt",t.lineJoin="round",t.lineWidth=this.K.It,s(t,this.K.Bt),t.lineWidth=1,t.beginPath(),1===this.K.J.length){const i=this.K.J[0],s=this.K.Ls/2;t.moveTo(i.tt-s,this.K.Is),t.lineTo(i.tt-s,i.it),t.lineTo(i.tt+s,i.it),t.lineTo(i.tt+s,this.K.Is)}else t.moveTo(this.K.J[this.K.G.from].tt,this.K.Is),t.lineTo(this.K.J[this.K.G.from].tt,this.K.J[this.K.G.from].it),nt(t,this.K.J,this.K.Bs,this.K.G),this.K.G.to>this.K.G.from&&(t.lineTo(this.K.J[this.K.G.to-1].tt,this.K.Is),t.lineTo(this.K.J[this.K.G.from].tt,this.K.Is));t.closePath(),t.fillStyle=this.Vs(t),t.fill()}}}class at extends lt{Vs(t){const i=this.K,s=t.createLinearGradient(0,0,0,i.Fs);return s.addColorStop(0,i.zs),s.addColorStop(1,i.Ws),s}}class ot extends O{constructor(){super(...arguments),this.K=null}Z(t){this.K=t}q(t){if(null!==this.K&&0!==this.K.J.length&&null!==this.K.G)if(t.lineCap="butt",t.lineWidth=this.K.It,s(t,this.K.Bt),t.strokeStyle=this.js(t),t.lineJoin="round",1===this.K.J.length){t.beginPath();const i=this.K.J[0];t.moveTo(i.tt-this.K.Ls/2,i.it),t.lineTo(i.tt+this.K.Ls/2,i.it),void 0!==i.O&&(t.strokeStyle=i.O),t.stroke()}else this.$s(t,this.K)}$s(t,i){t.beginPath(),nt(t,i.J,i.Bs,i.G),t.stroke()}}class _t extends ot{$s(t,i){var s,n;const{J:e,G:r,Bs:h,et:l}=i;if(0===e.length||null===r)return;t.beginPath();const a=e[r.from];t.moveTo(a.tt,a.it);let o=null!==(s=a.O)&&void 0!==s?s:l;t.strokeStyle=o;const _=i=>{t.stroke(),t.beginPath(),t.strokeStyle=i,o=i};for(let i=r.from+1;i<r.to;++i){const s=e[i],r=null!==(n=s.O)&&void 0!==n?n:l;switch(h){case 0:t.lineTo(s.tt,s.it);break;case 1:t.lineTo(s.tt,e[i-1].it),r!==o&&(_(r),t.lineTo(s.tt,e[i-1].it)),t.lineTo(s.tt,s.it);break;case 2:{const[n,r]=ht(e,i-1,i);t.bezierCurveTo(n.tt,n.it,r.tt,r.it,s.tt,s.it);break}}1!==h&&r!==o&&(_(r),t.moveTo(s.tt,s.it))}t.stroke()}js(){return this.K.et}}function ut(t,i,s,n=0,e=t.length){let r=e-n;for(;0<r;){const e=r>>1,h=n+e;s(t[h],i)?(n=h+1,r-=e+1):r=e}return n}function ct(t,i,s,n=0,e=t.length){let r=e-n;for(;0<r;){const e=r>>1,h=n+e;s(i,t[h])?r=e:(n=h+1,r-=e+1)}return n}function dt(t,i){return t.rt<i}function ft(t,i){return t<i.rt}function pt(t,i,s){const n=i.Hs(),e=i.Us(),r=ut(t,n,dt),h=ct(t,e,ft);if(!s)return{from:r,to:h};let l=r,a=h;return r>0&&r<t.length&&t[r].rt>=n&&(l=r-1),h>0&&h<t.length&&t[h-1].rt<=e&&(a=h+1),{from:l,to:a}}class vt{constructor(t,i,s){this.qs=!0,this.Ys=!0,this.Xs=!0,this.Ks=[],this.Zs=null,this.Gs=t,this.Js=i,this.Qs=s}dt(t){this.qs=!0,"data"===t&&(this.Ys=!0),"options"===t&&(this.Xs=!0)}tn(){this.Ys&&(this.sn(),this.Ys=!1),this.qs&&(this.nn(),this.qs=!1),this.Xs&&(this.en(),this.Xs=!1)}rn(){this.Zs=null}nn(){const t=this.Gs.Tt(),i=this.Js.bt();if(this.rn(),i.vi()||t.vi())return;const s=i.hn();if(null===s)return;if(0===this.Gs._s().ln())return;const n=this.Gs.yt();null!==n&&(this.Zs=pt(this.Ks,s,this.Qs),this.an(t,i,n.Ct))}}class mt extends vt{constructor(t,i){super(t,i,!0)}an(t,i,s){i.on(this.Ks,x(this.Zs)),t._n(this.Ks,s,x(this.Zs))}un(t,i){return{rt:t,ht:i,tt:NaN,it:NaN}}en(){}sn(){const t=this.Gs.cn();this.Ks=this.Gs._s().dn().map((i=>{const s=i.Ct[3];return this.fn(i.pn,s,t)}))}}class wt extends mt{constructor(t,i){super(t,i),this.Ft=new P,this.vn=new at,this.mn=new _t,this.Ft.H([this.vn,this.mn])}vt(t,i){if(!this.Gs.St())return null;const s=this.Gs.V();return this.tn(),this.vn.Z({Bs:s.lineType,J:this.Ks,Bt:s.lineStyle,It:s.lineWidth,zs:s.topColor,Ws:s.bottomColor,Is:t,Fs:t,G:this.Zs,Ls:this.Js.bt().wn()}),this.mn.Z({Bs:s.lineType,J:this.Ks,et:s.lineColor,Bt:s.lineStyle,It:s.lineWidth,G:this.Zs,Ls:this.Js.bt().wn()}),this.Ft}fn(t,i){return this.un(t,i)}}class gt{constructor(){this.Nt=null,this.gn=0,this.bn=0}Z(t){this.Nt=t}U(t,i,s,n){if(null===this.Nt||0===this.Nt._s.length||null===this.Nt.G)return;if(this.gn=this.Mn(i),this.gn>=2){Math.max(1,Math.floor(i))%2!=this.gn%2&&this.gn--}this.bn=this.Nt.Sn?Math.min(this.gn,Math.floor(i)):this.gn;let e=null;const r=this.bn<=this.gn&&this.Nt.wn>=Math.floor(1.5*i);for(let s=this.Nt.G.from;s<this.Nt.G.to;++s){const n=this.Nt._s[s];e!==n.O&&(t.fillStyle=n.O,e=n.O);const h=Math.floor(.5*this.bn),l=Math.round(n.tt*i),a=l-h,o=this.bn,_=a+o-1,u=Math.min(n.yn,n.kn),c=Math.max(n.yn,n.kn),d=Math.round(u*i)-h,f=Math.round(c*i)+h,p=Math.max(f-d,this.bn);t.fillRect(a,d,o,p);const v=Math.ceil(1.5*this.gn);if(r){if(this.Nt.xn){const s=l-v;let e=Math.max(d,Math.round(n.Tn*i)-h),r=e+o-1;r>d+p-1&&(r=d+p-1,e=r-o+1),t.fillRect(s,e,a-s,r-e+1)}const s=l+v;let e=Math.max(d,Math.round(n.Cn*i)-h),r=e+o-1;r>d+p-1&&(r=d+p-1,e=r-o+1),t.fillRect(_+1,e,s-_,r-e+1)}}}Mn(t){const i=Math.floor(t);return Math.max(i,Math.floor(function(t,i){return Math.floor(.3*t*i)}(h(this.Nt).wn,t)))}}class bt extends vt{constructor(t,i){super(t,i,!1)}an(t,i,s){i.on(this.Ks,x(this.Zs)),t.Dn(this.Ks,s,x(this.Zs))}Pn(t,i,s){return{rt:t,On:i.Ct[0],Nn:i.Ct[1],Rn:i.Ct[2],En:i.Ct[3],tt:NaN,Tn:NaN,yn:NaN,kn:NaN,Cn:NaN}}sn(){const t=this.Gs.cn();this.Ks=this.Gs._s().dn().map((i=>this.fn(i.pn,i,t)))}}class Mt extends bt{constructor(){super(...arguments),this.Ft=new gt}vt(t,i){if(!this.Gs.St())return null;const s=this.Gs.V();this.tn();const n={_s:this.Ks,wn:this.Js.bt().wn(),xn:s.openVisible,Sn:s.thinBars,G:this.Zs};return this.Ft.Z(n),this.Ft}en(){this.Ks.forEach((t=>{t.O=this.Gs.cn().Ln(t.rt).An}))}fn(t,i,s){return Object.assign(Object.assign({},this.Pn(t,i,s)),{O:s.Ln(t).An})}}function St(t,i,s){return Math.min(Math.max(t,i),s)}function yt(t,i,s){return i-t<=s}function kt(t){return t<=0?NaN:Math.log(t)/Math.log(10)}function xt(t){const i=Math.ceil(t);return i%2!=0?i-1:i}function Tt(t){const i=Math.ceil(t);return i%2==0?i-1:i}class Ct extends lt{Vs(t){const i=this.K,s=t.createLinearGradient(0,0,0,i.Fs),n=St(i.Is/i.Fs,0,1);return s.addColorStop(0,i.In),s.addColorStop(n,i.Bn),s.addColorStop(n,i.Vn),s.addColorStop(1,i.Fn),s}}class Dt extends ot{js(t){const i=this.K,s=t.createLinearGradient(0,0,0,i.Fs),n=St(i.Is/i.Fs,0,1);return s.addColorStop(0,i.zs),s.addColorStop(n,i.zs),s.addColorStop(n,i.Ws),s.addColorStop(1,i.Ws),s}}class Pt extends mt{constructor(t,i){super(t,i),this.zn=new Ct,this.Wn=new Dt,this.lt=new P,this.lt.H([this.zn,this.Wn])}vt(t,i){if(!this.Gs.St())return null;const s=this.Gs.yt();if(null===s)return null;const n=this.Gs.V();this.tn();const e=this.Gs.Tt().xt(n.baseValue.price,s.Ct),r=this.Js.bt().wn();return this.zn.Z({J:this.Ks,In:n.topFillColor1,Bn:n.topFillColor2,Vn:n.bottomFillColor1,Fn:n.bottomFillColor2,It:n.lineWidth,Bt:n.lineStyle,Bs:n.lineType,Is:e,Fs:t,G:this.Zs,Ls:r}),this.Wn.Z({J:this.Ks,zs:n.topLineColor,Ws:n.bottomLineColor,It:n.lineWidth,Bt:n.lineStyle,Bs:n.lineType,Is:e,Fs:t,G:this.Zs,Ls:r}),this.lt}fn(t,i){return this.un(t,i)}}class Ot{constructor(){this.Nt=null,this.gn=0}Z(t){this.Nt=t}U(t,i,s,n){if(null===this.Nt||0===this.Nt._s.length||null===this.Nt.G)return;if(this.gn=function(t,i){if(t>=2.5&&t<=4)return Math.floor(3*i);const s=1-.2*Math.atan(Math.max(4,t)-4)/(.5*Math.PI),n=Math.floor(t*s*i),e=Math.floor(t*i),r=Math.min(n,e);return Math.max(Math.floor(i),r)}(this.Nt.wn,i),this.gn>=2){Math.floor(i)%2!=this.gn%2&&this.gn--}const e=this.Nt._s;this.Nt.jn&&this.$n(t,e,this.Nt.G,i),this.Nt.Hn&&this.Un(t,e,this.Nt.G,this.Nt.wn,i);const r=this.qn(i);(!this.Nt.Hn||this.gn>2*r)&&this.Yn(t,e,this.Nt.G,i)}$n(t,i,s,n){if(null===this.Nt)return;let e="",r=Math.min(Math.floor(n),Math.floor(this.Nt.wn*n));r=Math.max(Math.floor(n),Math.min(r,this.gn));const h=Math.floor(.5*r);let l=null;for(let a=s.from;a<s.to;a++){const s=i[a];s.Xn!==e&&(t.fillStyle=s.Xn,e=s.Xn);const o=Math.round(Math.min(s.Tn,s.Cn)*n),_=Math.round(Math.max(s.Tn,s.Cn)*n),u=Math.round(s.yn*n),c=Math.round(s.kn*n);let d=Math.round(n*s.tt)-h;const f=d+r-1;null!==l&&(d=Math.max(l+1,d),d=Math.min(d,f));const p=f-d+1;t.fillRect(d,u,p,o-u),t.fillRect(d,_+1,p,c-_),l=f}}qn(t){let i=Math.floor(1*t);this.gn<=2*i&&(i=Math.floor(.5*(this.gn-1)));const s=Math.max(Math.floor(t),i);return this.gn<=2*s?Math.max(Math.floor(t),Math.floor(1*t)):s}Un(t,i,s,n,e){if(null===this.Nt)return;let r="";const h=this.qn(e);let l=null;for(let n=s.from;n<s.to;n++){const s=i[n];s.Dt!==r&&(t.fillStyle=s.Dt,r=s.Dt);let a=Math.round(s.tt*e)-Math.floor(.5*this.gn);const o=a+this.gn-1,_=Math.round(Math.min(s.Tn,s.Cn)*e),u=Math.round(Math.max(s.Tn,s.Cn)*e);if(null!==l&&(a=Math.max(l+1,a),a=Math.min(a,o)),this.Nt.wn*e>2*h)B(t,a,_,o-a+1,u-_+1,h);else{const i=o-a+1;t.fillRect(a,_,i,u-_+1)}l=o}}Yn(t,i,s,n){if(null===this.Nt)return;let e="";const r=this.qn(n);for(let h=s.from;h<s.to;h++){const s=i[h];let l=Math.round(Math.min(s.Tn,s.Cn)*n),a=Math.round(Math.max(s.Tn,s.Cn)*n),o=Math.round(s.tt*n)-Math.floor(.5*this.gn),_=o+this.gn-1;if(s.O!==e){const i=s.O;t.fillStyle=i,e=i}this.Nt.Hn&&(o+=r,l+=r,_-=r,a-=r),l>a||t.fillRect(o,l,_-o+1,a-l+1)}}}class Nt extends bt{constructor(){super(...arguments),this.Ft=new Ot}vt(t,i){if(!this.Gs.St())return null;const s=this.Gs.V();this.tn();const n={_s:this.Ks,wn:this.Js.bt().wn(),jn:s.wickVisible,Hn:s.borderVisible,G:this.Zs};return this.Ft.Z(n),this.Ft}en(){this.Ks.forEach((t=>{const i=this.Gs.cn().Ln(t.rt);t.O=i.An,t.Xn=i.Kn,t.Dt=i.Zn}))}fn(t,i,s){const n=s.Ln(t);return Object.assign(Object.assign({},this.Pn(t,i,s)),{O:n.An,Xn:n.Kn,Dt:n.Zn})}}class Rt{constructor(){this.Nt=null,this.Gn=[]}Z(t){this.Nt=t,this.Gn=[]}U(t,i,s,n){if(null===this.Nt||0===this.Nt.J.length||null===this.Nt.G)return;this.Gn.length||this.Jn(i);const e=Math.max(1,Math.floor(i)),r=Math.round(this.Nt.Qn*i)-Math.floor(e/2),h=r+e;for(let s=this.Nt.G.from;s<this.Nt.G.to;s++){const n=this.Nt.J[s],l=this.Gn[s-this.Nt.G.from],a=Math.round(n.it*i);let o,_;t.fillStyle=n.O,a<=r?(o=a,_=h):(o=r,_=a-Math.floor(e/2)+e),t.fillRect(l.Hs,o,l.Us-l.Hs+1,_-o)}}Jn(t){if(null===this.Nt||0===this.Nt.J.length||null===this.Nt.G)return void(this.Gn=[]);const i=Math.ceil(this.Nt.wn*t)<=1?0:Math.max(1,Math.floor(t)),s=Math.round(this.Nt.wn*t)-i;this.Gn=new Array(this.Nt.G.to-this.Nt.G.from);for(let i=this.Nt.G.from;i<this.Nt.G.to;i++){const n=this.Nt.J[i],e=Math.round(n.tt*t);let r,h;if(s%2){const t=(s-1)/2;r=e-t,h=e+t}else{const t=s/2;r=e-t,h=e+t-1}this.Gn[i-this.Nt.G.from]={Hs:r,Us:h,te:e,ie:n.tt*t,rt:n.rt}}for(let t=this.Nt.G.from+1;t<this.Nt.G.to;t++){const s=this.Gn[t-this.Nt.G.from],n=this.Gn[t-this.Nt.G.from-1];s.rt===n.rt+1&&(s.Hs-n.Us!==i+1&&(n.te>n.ie?n.Us=s.Hs-i-1:s.Hs=n.Us+i+1))}let n=Math.ceil(this.Nt.wn*t);for(let t=this.Nt.G.from;t<this.Nt.G.to;t++){const i=this.Gn[t-this.Nt.G.from];i.Us<i.Hs&&(i.Us=i.Hs);const s=i.Us-i.Hs+1;n=Math.min(s,n)}if(i>0&&n<4)for(let t=this.Nt.G.from;t<this.Nt.G.to;t++){const i=this.Gn[t-this.Nt.G.from];i.Us-i.Hs+1>n&&(i.te>i.ie?i.Us-=1:i.Hs+=1)}}}function Et(t){return{J:[],wn:t,Qn:NaN,G:null}}function At(t,i,s){return{rt:t,ht:i,tt:NaN,it:NaN,O:s}}class Lt extends vt{constructor(t,i){super(t,i,!1),this.lt=new P,this.se=Et(0),this.Ft=new Rt}vt(t,i){return this.Gs.St()?(this.tn(),this.lt):null}sn(){const t=this.Js.bt().wn();this.se=Et(t);let i=0,s=0;const n=this.Gs.V().color;for(const t of this.Gs._s().dn()){const e=t.Ct[3],r=void 0!==t.O?t.O:n,h=At(t.pn,e,r);i++,i<this.se.J.length?this.se.J[i]=h:this.se.J.push(h),this.Ks[s++]={rt:t.pn,tt:0}}this.Ft.Z(this.se),this.lt.H([this.Ft])}en(){}rn(){super.rn(),this.se.G=null}an(t,i,s){if(null===this.Zs)return;const n=i.wn(),e=h(i.hn()),r=t.xt(this.Gs.V().base,s);i.on(this.se.J),t._n(this.se.J,s),this.se.Qn=r,this.se.G=pt(this.se.J,e,!1),this.se.wn=n,this.Ft.Z(this.se)}}class It extends mt{constructor(t,i){super(t,i),this.mn=new _t}vt(t,i){if(!this.Gs.St())return null;const s=this.Gs.V();this.tn();const n={J:this.Ks,et:s.color,Bt:s.lineStyle,Bs:s.lineType,It:s.lineWidth,G:this.Zs,Ls:this.Js.bt().wn()};return this.mn.Z(n),this.mn}en(){this.Ks.forEach((t=>{t.O=this.Gs.cn().Ln(t.rt).An}))}fn(t,i,s){const n=this.un(t,i);return n.O=s.Ln(t).An,n}}const Bt=/[2-9]/g;class Vt{constructor(t=50){this.ne=new Map,this.ee=0,this.re=Array.from(new Array(t))}he(){this.ne.clear(),this.re.fill(void 0)}Qt(t,i,s){const n=s||Bt,e=String(i).replace(n,"0");let r=this.ne.get(e);if(void 0===r){if(r=t.measureText(e).width,0===r&&0!==i.length)return 0;const s=this.re[this.ee];void 0!==s&&this.ne.delete(s),this.re[this.ee]=e,this.ee=(this.ee+1)%this.re.length,this.ne.set(e,r)}return r}}class Ft{constructor(t){this.le=null,this.S=null,this.ae="right",this.oe=0,this._e=t}ue(t,i,s,n){this.le=t,this.S=i,this.oe=s,this.ae=n}U(t,i){null!==this.S&&null!==this.le&&this.le.U(t,this.S,this._e,this.oe,this.ae,i)}}class zt{constructor(t,i,s){this.ce=t,this._e=new Vt(50),this.de=i,this.B=s,this.F=-1,this.Ft=new Ft(this._e)}vt(t,i){const s=this.B.fe(this.de);if(null===s)return null;const n=s.pe(this.de)?s.ve():this.de.Tt();if(null===n)return null;const e=s.me(n);if("overlay"===e)return null;const r=this.B.we();return r.C!==this.F&&(this.F=r.C,this._e.he()),this.Ft.ue(this.ce.ci(),r,i,e),this.Ft}}class Wt{constructor(){this.Nt=null}Z(t){this.Nt=t}U(t,i,e,r){if(null===this.Nt)return;if(!1===this.Nt.St)return;const h=Math.round(this.Nt.it*i);if(h<0||h>Math.ceil(this.Nt.qt*i))return;const l=Math.ceil(this.Nt.Ut*i);t.lineCap="butt",t.strokeStyle=this.Nt.O,t.lineWidth=Math.floor(this.Nt.It*i),s(t,this.Nt.Bt),n(t,h,0,l)}}class jt{constructor(t){this.ge={Ut:0,qt:0,it:0,O:"rgba(0, 0, 0, 0)",It:1,Bt:0,St:!1},this.be=new Wt,this.ut=!0,this.Gs=t,this.Js=t.jt(),this.be.Z(this.ge)}dt(){this.ut=!0}vt(t,i){return this.Gs.St()?(this.ut&&(this.Me(t,i),this.ut=!1),this.be):null}}class $t extends jt{constructor(t){super(t)}Me(t,i){this.ge.St=!1;const s=this.Gs.Tt(),n=s.Se().Se;if(2!==n&&3!==n)return;const e=this.Gs.V();if(!e.baseLineVisible||!this.Gs.St())return;const r=this.Gs.yt();null!==r&&(this.ge.St=!0,this.ge.it=s.xt(r.Ct,r.Ct),this.ge.Ut=i,this.ge.qt=t,this.ge.O=e.baseLineColor,this.ge.It=e.baseLineWidth,this.ge.Bt=e.baseLineStyle)}}class Ht{constructor(){this.Nt=null}Z(t){this.Nt=t}ye(){return this.Nt}U(t,i,s,n){const e=this.Nt;if(null===e)return;t.save();const r=Math.max(1,Math.floor(i)),h=r%2/2,l=Math.round(e.ie.x*i)+h,a=e.ie.y*i;t.fillStyle=e.ke,t.beginPath();const o=Math.max(2,1.5*e.xe)*i;t.arc(l,a,o,0,2*Math.PI,!1),t.fill(),t.fillStyle=e.Te,t.beginPath(),t.arc(l,a,e.nt*i,0,2*Math.PI,!1),t.fill(),t.lineWidth=r,t.strokeStyle=e.Ce,t.beginPath(),t.arc(l,a,e.nt*i+r/2,0,2*Math.PI,!1),t.stroke(),t.restore()}}const Ut=[{De:0,Pe:.25,Oe:4,Ne:10,Re:.25,Ee:0,Ae:.4,Le:.8},{De:.25,Pe:.525,Oe:10,Ne:14,Re:0,Ee:0,Ae:.8,Le:0},{De:.525,Pe:1,Oe:14,Ne:14,Re:0,Ee:0,Ae:0,Le:0}];function qt(t,i,s,n){return function(t,i){if("transparent"===t)return t;const s=p(t),n=s[3];return`rgba(${s[0]}, ${s[1]}, ${s[2]}, ${i*n})`}(t,s+(n-s)*i)}function Yt(t,i){const s=t%2600/2600;let n;for(const t of Ut)if(s>=t.De&&s<=t.Pe){n=t;break}e(void 0!==n,"Last price animation internal logic error");const r=(s-n.De)/(n.Pe-n.De);return{Te:qt(i,r,n.Re,n.Ee),Ce:qt(i,r,n.Ae,n.Le),nt:(h=r,l=n.Oe,a=n.Ne,l+(a-l)*h)};var h,l,a}class Xt{constructor(t){this.Ft=new Ht,this.ut=!0,this.Ie=!0,this.Be=performance.now(),this.Ve=this.Be-1,this.Fe=t}ze(){this.Ve=this.Be-1,this.dt()}We(){if(this.dt(),2===this.Fe.V().lastPriceAnimation){const t=performance.now(),i=this.Ve-t;if(i>0)return void(i<650&&(this.Ve+=2600));this.Be=t,this.Ve=t+2600}}dt(){this.ut=!0}je(){this.Ie=!0}St(){return 0!==this.Fe.V().lastPriceAnimation}$e(){switch(this.Fe.V().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Ve}}vt(t,i){return this.ut?(this.wt(t,i),this.ut=!1,this.Ie=!1):this.Ie&&(this.He(),this.Ie=!1),this.Ft}wt(t,i){this.Ft.Z(null);const s=this.Fe.jt().bt(),n=s.hn(),e=this.Fe.yt();if(null===n||null===e)return;const r=this.Fe.Ue(!0);if(r.qe||!n.Ye(r.pn))return;const h={x:s.Ot(r.pn),y:this.Fe.Tt().xt(r.ht,e.Ct)},l=r.O,a=this.Fe.V().lineWidth,o=Yt(this.Xe(),l);this.Ft.Z({ke:l,xe:a,Te:o.Te,Ce:o.Ce,nt:o.nt,ie:h})}He(){const t=this.Ft.ye();if(null!==t){const i=Yt(this.Xe(),t.ke);t.Te=i.Te,t.Ce=i.Ce,t.nt=i.nt}}Xe(){return this.$e()?performance.now()-this.Be:2599}}function Kt(t,i){return Tt(Math.min(Math.max(t,12),30)*i)}function Zt(t,i){switch(t){case"arrowDown":case"arrowUp":return Kt(i,1);case"circle":return Kt(i,.8);case"square":return Kt(i,.7)}}function Gt(t){return xt(Kt(t,1))}function Jt(t){return Math.max(Kt(t,.1),3)}function Qt(t,i,s,n,e){const r=Zt("square",s),h=(r-1)/2,l=t-h,a=i-h;return n>=l&&n<=l+r&&e>=a&&e<=a+r}function ti(t,i,s,n,e){const r=(Zt("arrowUp",e)-1)/2,h=(Tt(e/2)-1)/2;i.beginPath(),t?(i.moveTo(s-r,n),i.lineTo(s,n-r),i.lineTo(s+r,n),i.lineTo(s+h,n),i.lineTo(s+h,n+r),i.lineTo(s-h,n+r),i.lineTo(s-h,n)):(i.moveTo(s-r,n),i.lineTo(s,n+r),i.lineTo(s+r,n),i.lineTo(s+h,n),i.lineTo(s+h,n-r),i.lineTo(s-h,n-r),i.lineTo(s-h,n)),i.fill()}function ii(t,i,s,n,e,r){return Qt(i,s,n,e,r)}class si extends O{constructor(){super(...arguments),this.Nt=null,this._e=new Vt,this.F=-1,this.W="",this.Ke=""}Z(t){this.Nt=t}ue(t,i){this.F===t&&this.W===i||(this.F=t,this.W=i,this.Ke=C(t,i),this._e.he())}Ze(t,i){if(null===this.Nt||null===this.Nt.G)return null;for(let s=this.Nt.G.from;s<this.Nt.G.to;s++){const n=this.Nt.J[s];if(ei(n,t,i))return{Ge:n.Je,Qe:n.Qe}}return null}q(t,i,s){if(null!==this.Nt&&null!==this.Nt.G){t.textBaseline="middle",t.font=this.Ke;for(let i=this.Nt.G.from;i<this.Nt.G.to;i++){const s=this.Nt.J[i];void 0!==s.Jt&&(s.Jt.Ut=this._e.Qt(t,s.Jt.tr),s.Jt.qt=this.F),ni(s,t)}}}}function ni(t,i){i.fillStyle=t.O,void 0!==t.Jt&&function(t,i,s,n){t.fillText(i,s,n)}(i,t.Jt.tr,t.tt-t.Jt.Ut/2,t.Jt.it),function(t,i){if(0===t.ln)return;switch(t.ir){case"arrowDown":return void ti(!1,i,t.tt,t.it,t.ln);case"arrowUp":return void ti(!0,i,t.tt,t.it,t.ln);case"circle":return void function(t,i,s,n){const e=(Zt("circle",n)-1)/2;t.beginPath(),t.arc(i,s,e,0,2*Math.PI,!1),t.fill()}(i,t.tt,t.it,t.ln);case"square":return void function(t,i,s,n){const e=Zt("square",n),r=(e-1)/2,h=i-r,l=s-r;t.fillRect(h,l,e,e)}(i,t.tt,t.it,t.ln)}t.ir}(t,i)}function ei(t,i,s){return!(void 0===t.Jt||!function(t,i,s,n,e,r){const h=n/2;return e>=t&&e<=t+s&&r>=i-h&&r<=i+h}(t.tt,t.Jt.it,t.Jt.Ut,t.Jt.qt,i,s))||function(t,i,s){if(0===t.ln)return!1;switch(t.ir){case"arrowDown":case"arrowUp":return ii(0,t.tt,t.it,t.ln,i,s);case"circle":return function(t,i,s,n,e){const r=2+Zt("circle",s)/2,h=t-n,l=i-e;return Math.sqrt(h*h+l*l)<=r}(t.tt,t.it,t.ln,i,s);case"square":return Qt(t.tt,t.it,t.ln,i,s)}}(t,i,s)}function ri(t,i,s,n,e,r,h,l,a){const o=g(s)?s:s.En,_=g(s)?s:s.Nn,u=g(s)?s:s.Rn,c=g(i.size)?Math.max(i.size,0):1,d=Gt(l.wn())*c,f=d/2;if(t.ln=d,"number"==typeof i.position)return t.it=h.xt(i.position,a),void(void 0!==t.Jt&&(t.Jt.it=t.it+f+r+.6*e));switch(i.position){case"inBar":return t.it=h.xt(o,a),void(void 0!==t.Jt&&(t.Jt.it=t.it+f+r+.6*e));case"aboveBar":return t.it=h.xt(_,a)-f-n.sr,void 0!==t.Jt&&(t.Jt.it=t.it-f-.6*e,n.sr+=1.2*e),void(n.sr+=d+r);case"belowBar":return t.it=h.xt(u,a)+f+n.nr,void 0!==t.Jt&&(t.Jt.it=t.it+f+r+.6*e,n.nr+=1.2*e),void(n.nr+=d+r)}i.position}class hi{constructor(t,i){this.ut=!0,this.er=!0,this.rr=!0,this.hr=null,this.Ft=new si,this.Fe=t,this.bi=i,this.Nt={J:[],G:null}}dt(t){this.ut=!0,this.rr=!0,"data"===t&&(this.er=!0)}vt(t,i,s){if(!this.Fe.St())return null;this.ut&&this.tn();const n=this.bi.V().layout;return this.Ft.ue(n.fontSize,n.fontFamily),this.Ft.Z(this.Nt),this.Ft}lr(){if(this.rr){if(this.Fe.ar().length>0){const t=this.bi.bt().wn(),i=Jt(t),s=1.5*Gt(t)+2*i;this.hr={above:s,below:s}}else this.hr=null;this.rr=!1}return this.hr}tn(){const t=this.Fe.Tt(),i=this.bi.bt(),s=this.Fe.ar();this.er&&(this.Nt.J=s.map((t=>({rt:t.time,tt:0,it:0,ln:0,ir:t.shape,O:t.color,Je:t.internalId,Qe:t.id,Jt:void 0}))),this.er=!1);const n=this.bi.V().layout;this.Nt.G=null;const e=i.hn();if(null===e)return;const r=this.Fe.yt();if(null===r)return;if(0===this.Nt.J.length)return;let h=NaN;const l=Jt(i.wn()),a={sr:l,nr:l};this.Nt.G=pt(this.Nt.J,e,!0);for(let e=this.Nt.G.from;e<this.Nt.G.to;e++){const o=s[e];o.time!==h&&(a.sr=l,a.nr=l,h=o.time);const _=this.Nt.J[e];_.tt=i.Ot(o.time),void 0!==o.text&&o.text.length>0&&(_.Jt={tr:o.text,it:0,Ut:0,qt:0});const u=this.Fe._r(o.time);null!==u&&ri(_,o,u,a,n.fontSize,l,t,i,r.Ct)}this.ut=!1}}class li extends jt{constructor(t){super(t)}Me(t,i){const s=this.ge;s.St=!1;const n=this.Gs.V();if(!n.priceLineVisible||!this.Gs.St())return;const e=this.Gs.Ue(0===n.priceLineSource);e.qe||(s.St=!0,s.it=e.ti,s.O=this.Gs.ur(e.O),s.Ut=i,s.qt=t,s.It=n.priceLineWidth,s.Bt=n.priceLineStyle)}}class ai extends j{constructor(t){super(),this.zt=t}di(t,i,s){t.St=!1,i.St=!1;const n=this.zt;if(!n.St())return;const e=n.V(),r=e.lastValueVisible,h=""!==n.cr(),l=0===e.seriesLastValueMode,a=n.Ue(!1);if(a.qe)return;r&&(t.Jt=this.dr(a,r,l),t.St=0!==t.Jt.length),(h||l)&&(i.Jt=this.pr(a,r,h,l),i.St=i.Jt.length>0);const o=n.ur(a.O),_=v(o);s.t=_.t,s.O=_.i,s.ti=a.ti,i.Dt=n.jt().Pt(a.ti/n.Tt().qt()),t.Dt=o}pr(t,i,s,n){let e="";const r=this.zt.cr();return s&&0!==r.length&&(e+=`${r} `),i&&n&&(e+=this.zt.Tt().vr()?t.mr:t.wr),e.trim()}dr(t,i,s){return i?s?this.zt.Tt().vr()?t.wr:t.mr:t.Jt:""}}class oi{constructor(t,i){this.gr=t,this.br=i}Mr(t){return null!==t&&(this.gr===t.gr&&this.br===t.br)}Sr(){return new oi(this.gr,this.br)}yr(){return this.gr}kr(){return this.br}Tr(){return this.br-this.gr}vi(){return this.br===this.gr||Number.isNaN(this.br)||Number.isNaN(this.gr)}Cs(t){return null===t?this:new oi(Math.min(this.yr(),t.yr()),Math.max(this.kr(),t.kr()))}Cr(t){if(!g(t))return;if(0===this.br-this.gr)return;const i=.5*(this.br+this.gr);let s=this.br-i,n=this.gr-i;s*=t,n*=t,this.br=i+s,this.gr=i+n}Dr(t){g(t)&&(this.br+=t,this.gr+=t)}Pr(){return{minValue:this.gr,maxValue:this.br}}static Or(t){return null===t?null:new oi(t.minValue,t.maxValue)}}class _i{constructor(t,i){this.Nr=t,this.Rr=i||null}Er(){return this.Nr}Ar(){return this.Rr}Pr(){return null===this.Nr?null:{priceRange:this.Nr.Pr(),margins:this.Rr||void 0}}static Or(t){return null===t?null:new _i(oi.Or(t.priceRange),t.margins)}}class ui extends jt{constructor(t,i){super(t),this.Lr=i}Me(t,i){const s=this.ge;s.St=!1;const n=this.Lr.V();if(!this.Gs.St()||!n.lineVisible)return;const e=this.Lr.Ir();null!==e&&(s.St=!0,s.it=e,s.O=n.color,s.Ut=i,s.qt=t,s.It=n.lineWidth,s.Bt=n.lineStyle)}}class ci extends j{constructor(t,i){super(),this.Fe=t,this.Lr=i}di(t,i,s){t.St=!1,i.St=!1;const n=this.Lr.V(),e=n.axisLabelVisible,r=""!==n.title,h=this.Fe;if(!e||!h.St())return;const l=this.Lr.Ir();if(null===l)return;r&&(i.Jt=n.title,i.St=!0),i.Dt=h.jt().Pt(l/h.Tt().qt()),t.Jt=this.Br(n.price),t.St=!0;const a=v(n.color);s.t=a.t,s.O=a.i,s.ti=l}Br(t){const i=this.Fe.yt();return null===i?"":this.Fe.Tt().mi(t,i.Ct)}}class di{constructor(t,i){this.Fe=t,this.Fi=i,this.Vr=new ui(t,this),this.ce=new ci(t,this),this.Fr=new zt(this.ce,t,t.jt())}zr(t){w(this.Fi,t),this.dt(),this.Fe.jt().Wr()}V(){return this.Fi}ss(){return[this.Vr,this.Fr]}jr(){return this.ce}dt(){this.Vr.dt(),this.ce.dt()}Ir(){const t=this.Fe,i=t.Tt();if(t.jt().bt().vi()||i.vi())return null;const s=t.yt();return null===s?null:i.xt(this.Fi.price,s.Ct)}}class fi extends Y{constructor(t){super(),this.bi=t}jt(){return this.bi}}const pi={An:"",Zn:"",Kn:""};class vi{constructor(t){this.Fe=t}Ln(t,i){const s=this.Fe.$r(),n=this.Fe.V();switch(s){case"Line":return this.Hr(n,t,i);case"Area":return this.Ur(n);case"Baseline":return this.qr(n,t,i);case"Bar":return this.Yr(n,t,i);case"Candlestick":return this.Xr(n,t,i);case"Histogram":return this.Kr(n,t,i)}throw new Error("Unknown chart style")}Yr(t,i,s){const n=Object.assign({},pi),e=t.upColor,r=t.downColor,a=e,o=r,_=h(this.Zr(i,s)),u=l(_.Ct[0])<=l(_.Ct[3]);return void 0!==_.O?(n.An=_.O,n.Zn=_.O):(n.An=u?e:r,n.Zn=u?a:o),n}Xr(t,i,s){var n,e,r;const a=Object.assign({},pi),o=t.upColor,_=t.downColor,u=t.borderUpColor,c=t.borderDownColor,d=t.wickUpColor,f=t.wickDownColor,p=h(this.Zr(i,s)),v=l(p.Ct[0])<=l(p.Ct[3]);return a.An=null!==(n=p.O)&&void 0!==n?n:v?o:_,a.Zn=null!==(e=p.Dt)&&void 0!==e?e:v?u:c,a.Kn=null!==(r=p.Xn)&&void 0!==r?r:v?d:f,a}Ur(t){return Object.assign(Object.assign({},pi),{An:t.lineColor})}qr(t,i,s){const n=h(this.Zr(i,s)).Ct[3]>=t.baseValue.price;return Object.assign(Object.assign({},pi),{An:n?t.topLineColor:t.bottomLineColor})}Hr(t,i,s){var n;const e=h(this.Zr(i,s));return Object.assign(Object.assign({},pi),{An:null!==(n=e.O)&&void 0!==n?n:t.color})}Kr(t,i,s){const n=Object.assign({},pi),e=h(this.Zr(i,s));return n.An=void 0!==e.O?e.O:t.color,n}Zr(t,i){return void 0!==i?i.Ct:this.Fe._s().Gr(t)}}var mi;!function(t){t[t.NearestLeft=-1]="NearestLeft",t[t.None=0]="None",t[t.NearestRight=1]="NearestRight"}(mi||(mi={}));const wi=30;class gi{constructor(){this.Jr=[],this.Qr=new Map,this.th=new Map}ih(){return this.ln()>0?this.Jr[this.Jr.length-1]:null}sh(){return this.ln()>0?this.nh(0):null}os(){return this.ln()>0?this.nh(this.Jr.length-1):null}ln(){return this.Jr.length}vi(){return 0===this.ln()}Ye(t){return null!==this.eh(t,0)}Gr(t){return this.rh(t)}rh(t,i=0){const s=this.eh(t,i);return null===s?null:Object.assign(Object.assign({},this.hh(s)),{pn:this.nh(s)})}dn(){return this.Jr}lh(t,i,s){if(this.vi())return null;let n=null;for(const e of s){n=bi(n,this.ah(t,i,e))}return n}Z(t){this.th.clear(),this.Qr.clear(),this.Jr=t}nh(t){return this.Jr[t].pn}hh(t){return this.Jr[t]}eh(t,i){const s=this.oh(t);if(null===s&&0!==i)switch(i){case-1:return this._h(t);case 1:return this.uh(t);default:throw new TypeError("Unknown search mode")}return s}_h(t){let i=this.dh(t);return i>0&&(i-=1),i!==this.Jr.length&&this.nh(i)<t?i:null}uh(t){const i=this.fh(t);return i!==this.Jr.length&&t<this.nh(i)?i:null}oh(t){const i=this.dh(t);return i===this.Jr.length||t<this.Jr[i].pn?null:i}dh(t){return ut(this.Jr,t,((t,i)=>t.pn<i))}fh(t){return ct(this.Jr,t,((t,i)=>i.pn>t))}ph(t,i,s){let n=null;for(let e=t;e<i;e++){const t=this.Jr[e].Ct[s];Number.isNaN(t)||(null===n?n={mh:t,wh:t}:(t<n.mh&&(n.mh=t),t>n.wh&&(n.wh=t)))}return n}ah(t,i,s){if(this.vi())return null;let n=null;const e=h(this.sh()),r=h(this.os()),l=Math.max(t,e),a=Math.min(i,r),o=Math.ceil(l/wi)*wi,_=Math.max(o,Math.floor(a/wi)*wi);{const t=this.dh(l),e=this.fh(Math.min(a,o,i));n=bi(n,this.ph(t,e,s))}let u=this.Qr.get(s);void 0===u&&(u=new Map,this.Qr.set(s,u));for(let t=Math.max(o+1,l);t<_;t+=wi){const i=Math.floor(t/wi);let e=u.get(i);if(void 0===e){const t=this.dh(i*wi),n=this.fh((i+1)*wi-1);e=this.ph(t,n,s),u.set(i,e)}n=bi(n,e)}{const t=this.dh(_),i=this.fh(a);n=bi(n,this.ph(t,i,s))}return n}}function bi(t,i){if(null===t)return i;if(null===i)return t;return{mh:Math.min(t.mh,i.mh),wh:Math.max(t.wh,i.wh)}}class Mi extends fi{constructor(t,i,s){super(t),this.Nt=new gi,this.Vr=new li(this),this.gh=[],this.bh=new $t(this),this.Mh=null,this.Sh=null,this.yh=[],this.kh=[],this.xh=null,this.Fi=i,this.Th=s;const n=new ai(this);this.Ei=[n],this.Fr=new zt(n,this,t),"Area"!==s&&"Line"!==s&&"Baseline"!==s||(this.Mh=new Xt(this)),this.Ch(),this.Dh()}M(){null!==this.xh&&clearTimeout(this.xh)}ur(t){return this.Fi.priceLineColor||t}Ue(t){const i={qe:!0},s=this.Tt();if(this.jt().bt().vi()||s.vi()||this.Nt.vi())return i;const n=this.jt().bt().hn(),e=this.yt();if(null===n||null===e)return i;let r,h;if(t){const t=this.Nt.ih();if(null===t)return i;r=t,h=t.pn}else{const t=this.Nt.rh(n.Us(),-1);if(null===t)return i;if(r=this.Nt.Gr(t.pn),null===r)return i;h=t.pn}const l=r.Ct[3],a=this.cn().Ln(h,{Ct:r}),o=s.xt(l,e.Ct);return{qe:!1,ht:l,Jt:s.mi(l,e.Ct),mr:s.Ph(l),wr:s.Oh(l,e.Ct),O:a.An,ti:o,pn:h}}cn(){return null!==this.Sh||(this.Sh=new vi(this)),this.Sh}V(){return this.Fi}zr(t){const i=t.priceScaleId;void 0!==i&&i!==this.Fi.priceScaleId&&this.jt().Nh(this,i),w(this.Fi,t),void 0!==t.priceFormat&&(this.Ch(),this.jt().Rh()),this.jt().Eh(this),this.jt().Ah(),this.qi.dt("options")}Z(t,i){this.Nt.Z(t),this.Lh(),this.qi.dt("data"),this.zi.dt("data"),null!==this.Mh&&(i&&i.Ih?this.Mh.We():0===t.length&&this.Mh.ze());const s=this.jt().fe(this);this.jt().Bh(s),this.jt().Eh(this),this.jt().Ah(),this.jt().Wr()}Vh(t){this.yh=t,this.Lh();const i=this.jt().fe(this);this.zi.dt("data"),this.jt().Bh(i),this.jt().Eh(this),this.jt().Ah(),this.jt().Wr()}Fh(){return this.yh}ar(){return this.kh}zh(t){const i=new di(this,t);return this.gh.push(i),this.jt().Eh(this),i}Wh(t){const i=this.gh.indexOf(t);-1!==i&&this.gh.splice(i,1),this.jt().Eh(this)}$r(){return this.Th}yt(){const t=this.jh();return null===t?null:{Ct:t.Ct[3],$h:t.rt}}jh(){const t=this.jt().bt().hn();if(null===t)return null;const i=t.Hs();return this.Nt.rh(i,1)}_s(){return this.Nt}_r(t){const i=this.Nt.Gr(t);return null===i?null:"Bar"===this.Th||"Candlestick"===this.Th?{On:i.Ct[0],Nn:i.Ct[1],Rn:i.Ct[2],En:i.Ct[3]}:i.Ct[3]}Hh(t){const i=this.Mh;return null!==i&&i.St()?(null===this.xh&&i.$e()&&(this.xh=setTimeout((()=>{this.xh=null,this.jt().Uh()}),0)),i.je(),[i]):[]}ss(){const t=[];this.qh()||t.push(this.bh),t.push(this.qi,this.Vr,this.Fr,this.zi);for(const i of this.gh)t.push(...i.ss());return t}ns(t,i){if(i!==this.yi&&!this.qh())return[];const s=[...this.Ei];for(const t of this.gh)s.push(t.jr());return s}Yh(t,i){if(void 0!==this.Fi.autoscaleInfoProvider){const s=this.Fi.autoscaleInfoProvider((()=>{const s=this.Xh(t,i);return null===s?null:s.Pr()}));return _i.Or(s)}return this.Xh(t,i)}Kh(){return this.Fi.priceFormat.minMove}Zh(){return this.Gh}rs(){var t;this.qi.dt(),this.zi.dt();for(const t of this.Ei)t.dt();for(const t of this.gh)t.dt();this.Vr.dt(),this.bh.dt(),null===(t=this.Mh)||void 0===t||t.dt()}Tt(){return h(super.Tt())}Mt(t){if(!(("Line"===this.Th||"Area"===this.Th||"Baseline"===this.Th)&&this.Fi.crosshairMarkerVisible))return null;const i=this.Nt.Gr(t);if(null===i)return null;return{ht:i.Ct[3],nt:this.Jh(),Dt:this.Qh(),kt:this.tl(t)}}cr(){return this.Fi.title}St(){return this.Fi.visible}qh(){return!Z(this.Tt().il())}Xh(t,i){if(!b(t)||!b(i)||this.Nt.vi())return null;const s="Line"===this.Th||"Area"===this.Th||"Baseline"===this.Th||"Histogram"===this.Th?[3]:[2,1],n=this.Nt.lh(t,i,s);let e=null!==n?new oi(n.mh,n.wh):null;if("Histogram"===this.$r()){const t=this.Fi.base,i=new oi(t,t);e=null!==e?e.Cs(i):i}return new _i(e,this.zi.lr())}Jh(){switch(this.Th){case"Line":case"Area":case"Baseline":return this.Fi.crosshairMarkerRadius}return 0}Qh(){switch(this.Th){case"Line":case"Area":case"Baseline":{const t=this.Fi.crosshairMarkerBorderColor;if(0!==t.length)return t}}return null}tl(t){switch(this.Th){case"Line":case"Area":case"Baseline":{const t=this.Fi.crosshairMarkerBackgroundColor;if(0!==t.length)return t}}return this.cn().Ln(t).An}Ch(){switch(this.Fi.priceFormat.type){case"custom":this.Gh={format:this.Fi.priceFormat.formatter};break;case"volume":this.Gh=new st(this.Fi.priceFormat.precision);break;case"percent":this.Gh=new it(this.Fi.priceFormat.precision);break;default:{const t=Math.pow(10,this.Fi.priceFormat.precision);this.Gh=new tt(t,this.Fi.priceFormat.minMove*t)}}null!==this.yi&&this.yi.sl()}Lh(){const t=this.jt().bt();if(t.vi()||0===this.Nt.ln())return void(this.kh=[]);const i=h(this.Nt.sh());this.kh=this.yh.map(((s,n)=>{const e=h(t.nl(s.time,!0)),r=e<i?1:-1;return{time:h(this.Nt.rh(e,r)).pn,position:s.position,shape:s.shape,color:s.color,id:s.id,internalId:n,text:s.text,size:s.size}}))}Dh(){switch(this.zi=new hi(this,this.jt()),this.Th){case"Bar":this.qi=new Mt(this,this.jt());break;case"Candlestick":this.qi=new Nt(this,this.jt());break;case"Line":this.qi=new It(this,this.jt());break;case"Area":this.qi=new wt(this,this.jt());break;case"Baseline":this.qi=new Pt(this,this.jt());break;case"Histogram":this.qi=new Lt(this,this.jt());break;default:throw Error("Unknown chart style assigned: "+this.Th)}}}class Si{constructor(t){this.Fi=t}el(t,i,s){let n=t;if(0===this.Fi.mode)return n;const e=s.ji(),r=e.yt();if(null===r)return n;const h=e.xt(t,r),a=s.rl().filter((t=>t instanceof Mi)).reduce(((t,n)=>{if(s.pe(n)||!n.St())return t;const e=n.Tt(),r=n._s();if(e.vi()||!r.Ye(i))return t;const h=r.Gr(i);if(null===h)return t;const a=l(n.yt());return t.concat([e.xt(h.Ct[3],a.Ct)])}),[]);if(0===a.length)return n;a.sort(((t,i)=>Math.abs(t-h)-Math.abs(i-h)));const o=a[0];return n=e.$i(o,r),n}}class yi{constructor(){this.Nt=null}Z(t){this.Nt=t}U(t,i,n,e){if(null===this.Nt)return;const r=Math.max(1,Math.floor(i));t.lineWidth=r;const l=Math.ceil(this.Nt.Lt*i),a=Math.ceil(this.Nt.At*i);!function(t,i){t.save(),t.lineWidth%2&&t.translate(.5,.5),i(),t.restore()}(t,(()=>{const n=h(this.Nt);if(n.hl){t.strokeStyle=n.ll,s(t,n.al),t.beginPath();for(const s of n.ol){const n=Math.round(s._l*i);t.moveTo(n,-r),t.lineTo(n,l+r)}t.stroke()}if(n.ul){t.strokeStyle=n.cl,s(t,n.dl),t.beginPath();for(const s of n.fl){const n=Math.round(s._l*i);t.moveTo(-r,n),t.lineTo(a+r,n)}t.stroke()}}))}}class ki{constructor(t){this.Ft=new yi,this.ut=!0,this.Pi=t}dt(){this.ut=!0}vt(t,i){if(this.ut){const s=this.Pi.jt().V().grid,n={Lt:t,At:i,ul:s.horzLines.visible,hl:s.vertLines.visible,cl:s.horzLines.color,ll:s.vertLines.color,dl:s.horzLines.style,al:s.vertLines.style,fl:this.Pi.ji().pl(),ol:this.Pi.jt().bt().pl()||[]};this.Ft.Z(n),this.ut=!1}return this.Ft}}class xi{constructor(t){this.qi=new ki(t)}vl(){return this.qi}}const Ti={ml:4,wl:1e-4};function Ci(t,i){const s=100*(t-i)/i;return i<0?-s:s}function Di(t,i){const s=Ci(t.yr(),i),n=Ci(t.kr(),i);return new oi(s,n)}function Pi(t,i){const s=100*(t-i)/i+100;return i<0?-s:s}function Oi(t,i){const s=Pi(t.yr(),i),n=Pi(t.kr(),i);return new oi(s,n)}function Ni(t,i){const s=Math.abs(t);if(s<1e-15)return 0;const n=kt(s+i.wl)+i.ml;return t<0?-n:n}function Ri(t,i){const s=Math.abs(t);if(s<1e-15)return 0;const n=Math.pow(10,s-i.ml)-i.wl;return t<0?-n:n}function Ei(t,i){if(null===t)return null;const s=Ni(t.yr(),i),n=Ni(t.kr(),i);return new oi(s,n)}function Ai(t,i){if(null===t)return null;const s=Ri(t.yr(),i),n=Ri(t.kr(),i);return new oi(s,n)}function Li(t){if(null===t)return Ti;const i=Math.abs(t.kr()-t.yr());if(i>=1||i<1e-15)return Ti;const s=Math.ceil(Math.abs(Math.log10(i))),n=Ti.ml+s;return{ml:n,wl:1/Math.pow(10,n)}}class Ii{constructor(t,i){if(this.gl=t,this.bl=i,function(t){if(t<0)return!1;for(let i=t;i>1;i/=10)if(i%10!=0)return!1;return!0}(this.gl))this.Ml=[2,2.5,2];else{this.Ml=[];for(let t=this.gl;1!==t;){if(t%2==0)this.Ml.push(2),t/=2;else{if(t%5!=0)throw new Error("unexpected base");this.Ml.push(2,2.5),t/=5}if(this.Ml.length>100)throw new Error("something wrong with base")}}}Sl(t,i,s){const n=0===this.gl?0:1/this.gl;let e=Math.pow(10,Math.max(0,Math.ceil(kt(t-i)))),r=0,h=this.bl[0];for(;;){const t=yt(e,n,1e-14)&&e>n+1e-14,i=yt(e,s*h,1e-14),l=yt(e,1,1e-14);if(!(t&&i&&l))break;e/=h,h=this.bl[++r%this.bl.length]}if(e<=n+1e-14&&(e=n),e=Math.max(1,e),this.Ml.length>0&&(l=e,a=1,o=1e-14,Math.abs(l-a)<o))for(r=0,h=this.Ml[0];yt(e,s*h,1e-14)&&e>n+1e-14;)e/=h,h=this.Ml[++r%this.Ml.length];var l,a,o;return e}}class Bi{constructor(t,i,s,n){this.yl=[],this.fi=t,this.gl=i,this.kl=s,this.xl=n}Sl(t,i){if(t<i)throw new Error("high < low");const s=this.fi.qt(),n=(t-i)*this.Tl()/s,e=new Ii(this.gl,[2,2.5,2]),r=new Ii(this.gl,[2,2,2.5]),h=new Ii(this.gl,[2.5,2,2]),l=[];return l.push(e.Sl(t,i,n),r.Sl(t,i,n),h.Sl(t,i,n)),function(t){if(t.length<1)throw Error("array is empty");let i=t[0];for(let s=1;s<t.length;++s)t[s]<i&&(i=t[s]);return i}(l)}Cl(){const t=this.fi,i=t.yt();if(null===i)return void(this.yl=[]);const s=t.qt(),n=this.kl(s-1,i),e=this.kl(0,i),r=this.fi.V().entireTextOnly?this.Dl()/2:0,h=r,l=s-1-r,a=Math.max(n,e),o=Math.min(n,e);if(a===o)return void(this.yl=[]);let _=this.Sl(a,o),u=a%_;u+=u<0?_:0;const c=a>=o?1:-1;let d=null,f=0;for(let s=a-u;s>o;s-=_){const n=this.xl(s,i,!0);null!==d&&Math.abs(n-d)<this.Tl()||(n<h||n>l||(f<this.yl.length?(this.yl[f]._l=n,this.yl[f].Pl=t.Ol(s)):this.yl.push({_l:n,Pl:t.Ol(s)}),f++,d=n,t.Nl()&&(_=this.Sl(s*c,o))))}this.yl.length=f}pl(){return this.yl}Dl(){return this.fi.C()}Tl(){return Math.ceil(2.5*this.Dl())}}function Vi(t){return t.slice().sort(((t,i)=>h(t.xi())-h(i.xi())))}var Fi;!function(t){t[t.Normal=0]="Normal",t[t.Logarithmic=1]="Logarithmic",t[t.Percentage=2]="Percentage",t[t.IndexedTo100=3]="IndexedTo100"}(Fi||(Fi={}));const zi=new it,Wi=new tt(100,1);class ji{constructor(t,i,s,n){this.Rl=0,this.El=null,this.Nr=null,this.Al=null,this.Ll={Il:!1,Bl:null},this.Vl=0,this.Fl=0,this.zl=new m,this.Wl=new m,this.jl=[],this.$l=null,this.Hl=null,this.Ul=null,this.ql=null,this.Gh=Wi,this.Yl=Li(null),this.Xl=t,this.Fi=i,this.Kl=s,this.Zl=n,this.Gl=new Bi(this,100,this.Jl.bind(this),this.Ql.bind(this))}il(){return this.Xl}V(){return this.Fi}zr(t){if(w(this.Fi,t),this.sl(),void 0!==t.mode&&this.ta({Se:t.mode}),void 0!==t.scaleMargins){const i=r(t.scaleMargins.top),s=r(t.scaleMargins.bottom);if(i<0||i>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${i}`);if(s<0||s>1||i+s>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${s}`);if(i+s>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${i+s}`);this.ia(),this.Hl=null}}sa(){return this.Fi.autoScale}Nl(){return 1===this.Fi.mode}vr(){return 2===this.Fi.mode}na(){return 3===this.Fi.mode}Se(){return{vs:this.Fi.autoScale,ea:this.Fi.invertScale,Se:this.Fi.mode}}ta(t){const i=this.Se();let s=null;void 0!==t.vs&&(this.Fi.autoScale=t.vs),void 0!==t.Se&&(this.Fi.mode=t.Se,2!==t.Se&&3!==t.Se||(this.Fi.autoScale=!0),this.Ll.Il=!1),1===i.Se&&t.Se!==i.Se&&(!function(t,i){if(null===t)return!1;const s=Ri(t.yr(),i),n=Ri(t.kr(),i);return isFinite(s)&&isFinite(n)}(this.Nr,this.Yl)?this.Fi.autoScale=!0:(s=Ai(this.Nr,this.Yl),null!==s&&this.ra(s))),1===t.Se&&t.Se!==i.Se&&(s=Ei(this.Nr,this.Yl),null!==s&&this.ra(s));const n=i.Se!==this.Fi.mode;n&&(2===i.Se||this.vr())&&this.sl(),n&&(3===i.Se||this.na())&&this.sl(),void 0!==t.ea&&i.ea!==t.ea&&(this.Fi.invertScale=t.ea,this.ha()),this.Wl.m(i,this.Se())}la(){return this.Wl}C(){return this.Kl.fontSize}qt(){return this.Rl}aa(t){this.Rl!==t&&(this.Rl=t,this.ia(),this.Hl=null)}oa(){if(this.El)return this.El;const t=this.qt()-this._a()-this.ua();return this.El=t,t}Er(){return this.ca(),this.Nr}ra(t,i){const s=this.Nr;(i||null===s&&null!==t||null!==s&&!s.Mr(t))&&(this.Hl=null,this.Nr=t)}vi(){return this.ca(),0===this.Rl||!this.Nr||this.Nr.vi()}da(t){return this.ea()?t:this.qt()-1-t}xt(t,i){return this.vr()?t=Ci(t,i):this.na()&&(t=Pi(t,i)),this.Ql(t,i)}_n(t,i,s){this.ca();const n=this.ua(),e=h(this.Er()),r=e.yr(),l=e.kr(),a=this.oa()-1,o=this.ea(),_=a/(l-r),u=void 0===s?0:s.from,c=void 0===s?t.length:s.to,d=this.fa();for(let s=u;s<c;s++){const e=t[s],h=e.ht;if(isNaN(h))continue;let l=h;null!==d&&(l=d(e.ht,i));const a=n+_*(l-r),u=o?a:this.Rl-1-a;e.it=u}}Dn(t,i,s){this.ca();const n=this.ua(),e=h(this.Er()),r=e.yr(),l=e.kr(),a=this.oa()-1,o=this.ea(),_=a/(l-r),u=void 0===s?0:s.from,c=void 0===s?t.length:s.to,d=this.fa();for(let s=u;s<c;s++){const e=t[s];let h=e.On,l=e.Nn,a=e.Rn,u=e.En;null!==d&&(h=d(e.On,i),l=d(e.Nn,i),a=d(e.Rn,i),u=d(e.En,i));let c=n+_*(h-r),f=o?c:this.Rl-1-c;e.Tn=f,c=n+_*(l-r),f=o?c:this.Rl-1-c,e.yn=f,c=n+_*(a-r),f=o?c:this.Rl-1-c,e.kn=f,c=n+_*(u-r),f=o?c:this.Rl-1-c,e.Cn=f}}$i(t,i){const s=this.Jl(t,i);return this.pa(s,i)}pa(t,i){let s=t;return this.vr()?s=function(t,i){return i<0&&(t=-t),t/100*i+i}(s,i):this.na()&&(s=function(t,i){return t-=100,i<0&&(t=-t),t/100*i+i}(s,i)),s}rl(){return this.jl}va(){if(this.$l)return this.$l;let t=[];for(let i=0;i<this.jl.length;i++){const s=this.jl[i];null===s.xi()&&s.Ti(i+1),t.push(s)}return t=Vi(t),this.$l=t,this.$l}ma(t){-1===this.jl.indexOf(t)&&(this.jl.push(t),this.sl(),this.wa())}ga(t){const i=this.jl.indexOf(t);if(-1===i)throw new Error("source is not attached to scale");this.jl.splice(i,1),0===this.jl.length&&(this.ta({vs:!0}),this.ra(null)),this.sl(),this.wa()}yt(){let t=null;for(const i of this.jl){const s=i.yt();null!==s&&((null===t||s.$h<t.$h)&&(t=s))}return null===t?null:t.Ct}ea(){return this.Fi.invertScale}pl(){const t=null===this.yt();if(null!==this.Hl&&(t||this.Hl.ba===t))return this.Hl.pl;this.Gl.Cl();const i=this.Gl.pl();return this.Hl={pl:i,ba:t},this.zl.m(),i}Ma(){return this.zl}Sa(t){this.vr()||this.na()||null===this.Ul&&null===this.Al&&(this.vi()||(this.Ul=this.Rl-t,this.Al=h(this.Er()).Sr()))}ya(t){if(this.vr()||this.na())return;if(null===this.Ul)return;this.ta({vs:!1}),(t=this.Rl-t)<0&&(t=0);let i=(this.Ul+.2*(this.Rl-1))/(t+.2*(this.Rl-1));const s=h(this.Al).Sr();i=Math.max(i,.1),s.Cr(i),this.ra(s)}ka(){this.vr()||this.na()||(this.Ul=null,this.Al=null)}xa(t){this.sa()||null===this.ql&&null===this.Al&&(this.vi()||(this.ql=t,this.Al=h(this.Er()).Sr()))}Ta(t){if(this.sa())return;if(null===this.ql)return;const i=h(this.Er()).Tr()/(this.oa()-1);let s=t-this.ql;this.ea()&&(s*=-1);const n=s*i,e=h(this.Al).Sr();e.Dr(n),this.ra(e,!0),this.Hl=null}Ca(){this.sa()||null!==this.ql&&(this.ql=null,this.Al=null)}Zh(){return this.Gh||this.sl(),this.Gh}mi(t,i){switch(this.Fi.mode){case 2:return this.Zh().format(Ci(t,i));case 3:return this.Zh().format(Pi(t,i));default:return this.Br(t)}}Ol(t){switch(this.Fi.mode){case 2:case 3:return this.Zh().format(t);default:return this.Br(t)}}Ph(t){return this.Br(t,h(this.Da()).Zh())}Oh(t,i){return t=Ci(t,i),zi.format(t)}Pa(){return this.jl}Oa(t){this.Ll={Bl:t,Il:!1}}rs(){this.jl.forEach((t=>t.rs()))}sl(){this.Hl=null;const t=this.Da();let i=100;null!==t&&(i=Math.round(1/t.Kh())),this.Gh=Wi,this.vr()?(this.Gh=zi,i=100):this.na()?(this.Gh=new tt(100,1),i=100):null!==t&&(this.Gh=t.Zh()),this.Gl=new Bi(this,i,this.Jl.bind(this),this.Ql.bind(this)),this.Gl.Cl()}wa(){this.$l=null}Da(){return this.jl[0]||null}_a(){return this.ea()?this.Fi.scaleMargins.bottom*this.qt()+this.Fl:this.Fi.scaleMargins.top*this.qt()+this.Vl}ua(){return this.ea()?this.Fi.scaleMargins.top*this.qt()+this.Vl:this.Fi.scaleMargins.bottom*this.qt()+this.Fl}ca(){this.Ll.Il||(this.Ll.Il=!0,this.Na())}ia(){this.El=null}Ql(t,i){if(this.ca(),this.vi())return 0;t=this.Nl()&&t?Ni(t,this.Yl):t;const s=h(this.Er()),n=this.ua()+(this.oa()-1)*(t-s.yr())/s.Tr();return this.da(n)}Jl(t,i){if(this.ca(),this.vi())return 0;const s=this.da(t),n=h(this.Er()),e=n.yr()+n.Tr()*((s-this.ua())/(this.oa()-1));return this.Nl()?Ri(e,this.Yl):e}ha(){this.Hl=null,this.Gl.Cl()}Na(){const t=this.Ll.Bl;if(null===t)return;let i=null;const s=this.Pa();let n=0,e=0;for(const r of s){if(!r.St())continue;const s=r.yt();if(null===s)continue;const l=r.Yh(t.Hs(),t.Us());let a=l&&l.Er();if(null!==a){switch(this.Fi.mode){case 1:a=Ei(a,this.Yl);break;case 2:a=Di(a,s.Ct);break;case 3:a=Oi(a,s.Ct)}if(i=null===i?a:i.Cs(h(a)),null!==l){const t=l.Ar();null!==t&&(n=Math.max(n,t.above),e=Math.max(n,t.below))}}}if(n===this.Vl&&e===this.Fl||(this.Vl=n,this.Fl=e,this.Hl=null,this.ia()),null!==i){if(i.yr()===i.kr()){const t=this.Da(),s=5*(null===t||this.vr()||this.na()?1:t.Kh());this.Nl()&&(i=Ai(i,this.Yl)),i=new oi(i.yr()-s,i.kr()+s),this.Nl()&&(i=Ei(i,this.Yl))}if(this.Nl()){const t=Ai(i,this.Yl),s=Li(t);if(r=s,l=this.Yl,r.ml!==l.ml||r.wl!==l.wl){const n=null!==this.Al?Ai(this.Al,this.Yl):null;this.Yl=s,i=Ei(t,s),null!==n&&(this.Al=Ei(n,s))}}this.ra(i)}else null===this.Nr&&(this.ra(new oi(-.5,.5)),this.Yl=Li(null));var r,l;this.Ll.Il=!0}fa(){return this.vr()?Ci:this.na()?Pi:this.Nl()?t=>Ni(t,this.Yl):null}Br(t,i){return void 0===this.Zl.priceFormatter?(void 0===i&&(i=this.Zh()),i.format(t)):this.Zl.priceFormatter(t)}}class $i{constructor(t,i){this.jl=[],this.Ra=new Map,this.Rl=0,this.oe=0,this.Ea=1e3,this.$l=null,this.Aa=new m,this.La=t,this.bi=i,this.Ia=new xi(this);const s=i.V();this.Ba=this.Va("left",s.leftPriceScale),this.Fa=this.Va("right",s.rightPriceScale),this.Ba.la().l(this.za.bind(this,this.Ba),this),this.Fa.la().l(this.za.bind(this,this.Fa),this),this.Wa(s)}Wa(t){if(t.leftPriceScale&&this.Ba.zr(t.leftPriceScale),t.rightPriceScale&&this.Fa.zr(t.rightPriceScale),t.localization&&(this.Ba.sl(),this.Fa.sl()),t.overlayPriceScales){const i=Array.from(this.Ra.values());for(const s of i){const i=h(s[0].Tt());i.zr(t.overlayPriceScales),t.localization&&i.sl()}}}ja(t){switch(t){case"left":return this.Ba;case"right":return this.Fa}return this.Ra.has(t)?r(this.Ra.get(t))[0].Tt():null}M(){this.jt().$a().v(this),this.Ba.la().v(this),this.Fa.la().v(this),this.jl.forEach((t=>{t.M&&t.M()})),this.Aa.m()}Ha(){return this.Ea}Ua(t){this.Ea=t}jt(){return this.bi}Ut(){return this.oe}qt(){return this.Rl}qa(t){this.oe=t,this.Ya()}aa(t){this.Rl=t,this.Ba.aa(t),this.Fa.aa(t),this.jl.forEach((i=>{if(this.pe(i)){const s=i.Tt();null!==s&&s.aa(t)}})),this.Ya()}rl(){return this.jl}pe(t){const i=t.Tt();return null===i||this.Ba!==i&&this.Fa!==i}ma(t,i,s){const n=void 0!==s?s:this.Ka().Xa+1;this.Za(t,i,n)}ga(t){const i=this.jl.indexOf(t);e(-1!==i,"removeDataSource: invalid data source"),this.jl.splice(i,1);const s=h(t.Tt()).il();if(this.Ra.has(s)){const i=r(this.Ra.get(s)),n=i.indexOf(t);-1!==n&&(i.splice(n,1),0===i.length&&this.Ra.delete(s))}const n=t.Tt();n&&n.rl().indexOf(t)>=0&&n.ga(t),null!==n&&(n.wa(),this.Ga(n)),this.$l=null}me(t){return t===this.Ba?"left":t===this.Fa?"right":"overlay"}Ja(){return this.Ba}Qa(){return this.Fa}io(t,i){t.Sa(i)}so(t,i){t.ya(i),this.Ya()}no(t){t.ka()}eo(t,i){t.xa(i)}ro(t,i){t.Ta(i),this.Ya()}ho(t){t.Ca()}Ya(){this.jl.forEach((t=>{t.rs()}))}ji(){let t=null;return this.bi.V().rightPriceScale.visible&&0!==this.Fa.rl().length?t=this.Fa:this.bi.V().leftPriceScale.visible&&0!==this.Ba.rl().length?t=this.Ba:0!==this.jl.length&&(t=this.jl[0].Tt()),null===t&&(t=this.Fa),t}ve(){let t=null;return this.bi.V().rightPriceScale.visible?t=this.Fa:this.bi.V().leftPriceScale.visible&&(t=this.Ba),t}Ga(t){null!==t&&t.sa()&&this.lo(t)}ao(t){const i=this.La.hn();t.ta({vs:!0}),null!==i&&t.Oa(i),this.Ya()}oo(){this.lo(this.Ba),this.lo(this.Fa)}_o(){this.Ga(this.Ba),this.Ga(this.Fa),this.jl.forEach((t=>{this.pe(t)&&this.Ga(t.Tt())})),this.Ya(),this.bi.Wr()}va(){return null===this.$l&&(this.$l=Vi(this.jl)),this.$l}uo(){return this.Aa}co(){return this.Ia}lo(t){const i=t.Pa();if(i&&i.length>0&&!this.La.vi()){const i=this.La.hn();null!==i&&t.Oa(i)}t.rs()}Ka(){const t=this.va();if(0===t.length)return{do:0,Xa:0};let i=0,s=0;for(let n=0;n<t.length;n++){const e=t[n].xi();null!==e&&(e<i&&(i=e),e>s&&(s=e))}return{do:i,Xa:s}}Za(t,i,s){let n=this.ja(i);if(null===n&&(n=this.Va(i,this.bi.V().overlayPriceScales)),this.jl.push(t),!Z(i)){const s=this.Ra.get(i)||[];s.push(t),this.Ra.set(i,s)}n.ma(t),t.Ci(n),t.Ti(s),this.Ga(n),this.$l=null}za(t,i,s){i.Se!==s.Se&&this.lo(t)}Va(t,i){const s=Object.assign({visible:!0,autoScale:!0},y(i)),n=new ji(t,s,this.bi.V().layout,this.bi.V().localization);return n.aa(this.qt()),n}}const Hi=t=>t.getUTCFullYear();function Ui(t,i,s){return i.replace(/yyyy/g,(t=>Q(Hi(t),4))(t)).replace(/yy/g,(t=>Q(Hi(t)%100,2))(t)).replace(/MMMM/g,((t,i)=>new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(i,{month:"long"}))(t,s)).replace(/MMM/g,((t,i)=>new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(i,{month:"short"}))(t,s)).replace(/MM/g,(t=>Q((t=>t.getUTCMonth()+1)(t),2))(t)).replace(/dd/g,(t=>Q((t=>t.getUTCDate())(t),2))(t))}class qi{constructor(t="yyyy-MM-dd",i="default"){this.fo=t,this.po=i}vo(t){return Ui(t,this.fo,this.po)}}class Yi{constructor(t){this.mo=t||"%h:%m:%s"}vo(t){return this.mo.replace("%h",Q(t.getUTCHours(),2)).replace("%m",Q(t.getUTCMinutes(),2)).replace("%s",Q(t.getUTCSeconds(),2))}}const Xi={wo:"yyyy-MM-dd",bo:"%h:%m:%s",Mo:" ",So:"default"};class Ki{constructor(t={}){const i=Object.assign(Object.assign({},Xi),t);this.yo=new qi(i.wo,i.So),this.ko=new Yi(i.bo),this.xo=i.Mo}vo(t){return`${this.yo.vo(t)}${this.xo}${this.ko.vo(t)}`}}class Zi{constructor(t,i=50){this.To=0,this.Co=1,this.Do=1,this.ne=new Map,this.Po=new Map,this.Oo=t,this.No=i}vo(t){const i=t.rt,s=void 0===i.Ro?new Date(1e3*i.Eo).getTime():new Date(Date.UTC(i.Ro.year,i.Ro.month-1,i.Ro.day)).getTime(),n=this.ne.get(s);if(void 0!==n)return n.Ao;if(this.To===this.No){const t=this.Po.get(this.Do);this.Po.delete(this.Do),this.ne.delete(r(t)),this.Do++,this.To--}const e=this.Oo(t);return this.ne.set(s,{Ao:e,Lo:this.Co}),this.Po.set(this.Co,s),this.To++,this.Co++,e}}class Gi{constructor(t,i){e(t<=i,"right should be >= left"),this.Io=t,this.Bo=i}Hs(){return this.Io}Us(){return this.Bo}Vo(){return this.Bo-this.Io+1}Ye(t){return this.Io<=t&&t<=this.Bo}Mr(t){return this.Io===t.Hs()&&this.Bo===t.Us()}}function Ji(t,i){return null===t||null===i?t===i:t.Mr(i)}class Qi{constructor(){this.Fo=new Map,this.ne=null}zo(t,i){this.Wo(i),this.ne=null;for(let s=i;s<t.length;++s){const i=t[s];let n=this.Fo.get(i.jo);void 0===n&&(n=[],this.Fo.set(i.jo,n)),n.push({pn:s,rt:i.rt,$o:i.jo,Ho:i.Ho})}}Uo(t,i){const s=Math.ceil(i/t);return null!==this.ne&&this.ne.qo===s||(this.ne={pl:this.Yo(s),qo:s}),this.ne.pl}Wo(t){if(0===t)return void this.Fo.clear();const i=[];this.Fo.forEach(((s,n)=>{t<=s[0].pn?i.push(n):s.splice(ut(s,t,(i=>i.pn<t)),1/0)}));for(const t of i)this.Fo.delete(t)}Yo(t){let i=[];for(const s of Array.from(this.Fo.keys()).sort(((t,i)=>i-t))){if(!this.Fo.get(s))continue;const n=i;i=[];const e=n.length;let h=0;const l=r(this.Fo.get(s)),a=l.length;let o=1/0,_=-1/0;for(let s=0;s<a;s++){const r=l[s],a=r.pn;for(;h<e;){const t=n[h],s=t.pn;if(!(s<a)){o=s;break}h++,i.push(t),_=s,o=1/0}o-a>=t&&a-_>=t&&(i.push(r),_=a)}for(;h<e;h++)i.push(n[h])}return i}}class ts{constructor(t){this.Xo=t}Ko(){return null===this.Xo?null:new Gi(Math.floor(this.Xo.Hs()),Math.ceil(this.Xo.Us()))}Zo(){return this.Xo}static Go(){return new ts(null)}}var is,ss,ns,es,rs;!function(t){t[t.Year=0]="Year",t[t.Month=1]="Month",t[t.DayOfMonth=2]="DayOfMonth",t[t.Time=3]="Time",t[t.TimeWithSeconds=4]="TimeWithSeconds"}(is||(is={}));class hs{constructor(t,i,s){this.oe=0,this.Jo=null,this.Qo=[],this.ql=null,this.Ul=null,this.t_=new Qi,this.i_=new Map,this.s_=ts.Go(),this.n_=!0,this.e_=new m,this.r_=new m,this.h_=new m,this.l_=null,this.a_=null,this.o_=[],this.Fi=i,this.Zl=s,this.__=i.rightOffset,this.u_=i.barSpacing,this.bi=t,this.c_()}V(){return this.Fi}d_(t){w(this.Zl,t),this.f_(),this.c_()}zr(t,i){var s;w(this.Fi,t),this.Fi.fixLeftEdge&&this.p_(),this.Fi.fixRightEdge&&this.v_(),void 0!==t.barSpacing&&this.bi.ks(t.barSpacing),void 0!==t.rightOffset&&this.bi.xs(t.rightOffset),void 0!==t.minBarSpacing&&this.bi.ks(null!==(s=t.barSpacing)&&void 0!==s?s:this.u_),this.f_(),this.c_(),this.h_.m()}Hi(t){var i,s;return null!==(s=null===(i=this.Qo[t])||void 0===i?void 0:i.rt)&&void 0!==s?s:null}Mi(t){var i;return null!==(i=this.Qo[t])&&void 0!==i?i:null}nl(t,i){if(this.Qo.length<1)return null;if(t.Eo>this.Qo[this.Qo.length-1].rt.Eo)return i?this.Qo.length-1:null;const s=ut(this.Qo,t.Eo,((t,i)=>t.rt.Eo<i));return t.Eo<this.Qo[s].rt.Eo?i?s:null:s}vi(){return 0===this.oe||0===this.Qo.length||null===this.Jo}hn(){return this.m_(),this.s_.Ko()}w_(){return this.m_(),this.s_.Zo()}g_(){const t=this.hn();if(null===t)return null;const i={from:t.Hs(),to:t.Us()};return this.b_(i)}b_(t){const i=Math.round(t.from),s=Math.round(t.to),n=h(this.M_()),e=h(this.S_());return{from:h(this.Hi(Math.max(n,i))),to:h(this.Hi(Math.min(e,s)))}}y_(t){return{from:h(this.nl(t.from,!0)),to:h(this.nl(t.to,!0))}}Ut(){return this.oe}qa(t){if(!isFinite(t)||t<=0)return;if(this.oe===t)return;const i=this.w_(),s=this.oe;if(this.oe=t,this.n_=!0,this.Fi.lockVisibleTimeRangeOnResize&&0!==s){const i=this.u_*t/s;this.u_=i}if(this.Fi.fixLeftEdge&&null!==i&&i.Hs()<=0){const i=s-t;this.__-=Math.round(i/this.u_)+1,this.n_=!0}this.k_(),this.x_()}Ot(t){if(this.vi()||!b(t))return 0;const i=this.T_()+this.__-t;return this.oe-(i+.5)*this.u_-1}on(t,i){const s=this.T_(),n=void 0===i?0:i.from,e=void 0===i?t.length:i.to;for(let i=n;i<e;i++){const n=t[i].rt,e=s+this.__-n,r=this.oe-(e+.5)*this.u_-1;t[i].tt=r}}C_(t){return Math.ceil(this.D_(t))}xs(t){this.n_=!0,this.__=t,this.x_(),this.bi.P_(),this.bi.Wr()}wn(){return this.u_}ks(t){this.O_(t),this.x_(),this.bi.P_(),this.bi.Wr()}N_(){return this.__}pl(){if(this.vi())return null;if(null!==this.a_)return this.a_;const t=this.u_,i=5*(this.bi.V().layout.fontSize+4),s=Math.round(i/t),n=h(this.hn()),e=Math.max(n.Hs(),n.Hs()-s),r=Math.max(n.Us(),n.Us()-s),l=this.t_.Uo(t,i),a=this.M_()+s,o=this.S_()-s,_=this.R_(),u=this.Fi.fixLeftEdge||_,c=this.Fi.fixRightEdge||_;let d=0;for(const t of l){if(!(e<=t.pn&&t.pn<=r))continue;let s;d<this.o_.length?(s=this.o_[d],s._l=this.Ot(t.pn),s.Pl=this.E_(t),s.$o=t.$o):(s={A_:!1,_l:this.Ot(t.pn),Pl:this.E_(t),$o:t.$o},this.o_.push(s)),this.u_>i/2&&!_?s.A_=!1:s.A_=u&&t.pn<=a||c&&t.pn>=o,d++}return this.o_.length=d,this.a_=this.o_,this.o_}L_(){this.n_=!0,this.ks(this.Fi.barSpacing),this.xs(this.Fi.rightOffset)}I_(t){this.n_=!0,this.Jo=t,this.x_(),this.p_()}B_(t,i){const s=this.D_(t),n=this.wn(),e=n+i*(n/10);this.ks(e),this.Fi.rightBarStaysOnScroll||this.xs(this.N_()+(s-this.D_(t)))}Sa(t){this.ql&&this.Ca(),null===this.Ul&&null===this.l_&&(this.vi()||(this.Ul=t,this.V_()))}ya(t){if(null===this.l_)return;const i=St(this.oe-t,0,this.oe),s=St(this.oe-h(this.Ul),0,this.oe);0!==i&&0!==s&&this.ks(this.l_.wn*i/s)}ka(){null!==this.Ul&&(this.Ul=null,this.F_())}xa(t){null===this.ql&&null===this.l_&&(this.vi()||(this.ql=t,this.V_()))}Ta(t){if(null===this.ql)return;const i=(this.ql-t)/this.wn();this.__=h(this.l_).N_+i,this.n_=!0,this.x_()}Ca(){null!==this.ql&&(this.ql=null,this.F_())}z_(){this.W_(this.Fi.rightOffset)}W_(t,i=400){if(!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(i)||i<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const s=this.__,n=performance.now(),e=()=>{const r=(performance.now()-n)/i,h=r>=1,l=h?t:s+(t-s)*r;this.xs(l),h||setTimeout(e,20)};e()}dt(t,i){this.n_=!0,this.Qo=t,this.t_.zo(t,i),this.x_()}j_(){return this.e_}H_(){return this.r_}U_(){return this.h_}T_(){return this.Jo||0}q_(t){const i=t.Vo();this.O_(this.oe/i),this.__=t.Us()-this.T_(),this.x_(),this.n_=!0,this.bi.P_(),this.bi.Wr()}Y_(){const t=this.M_(),i=this.S_();null!==t&&null!==i&&this.q_(new Gi(t,i+this.Fi.rightOffset))}X_(t){const i=new Gi(t.from,t.to);this.q_(i)}Si(t){return void 0!==this.Zl.timeFormatter?this.Zl.timeFormatter(t.Ho):this.K_.vo(new Date(1e3*t.rt.Eo))}R_(){const{handleScroll:t,handleScale:i}=this.bi.V();return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||i.axisDoubleClickReset||i.axisPressedMouseMove.time||i.mouseWheel||i.pinch)}M_(){return 0===this.Qo.length?null:0}S_(){return 0===this.Qo.length?null:this.Qo.length-1}Z_(t){return(this.oe-1-t)/this.u_}D_(t){const i=this.Z_(t),s=this.T_()+this.__-i;return Math.round(1e6*s)/1e6}O_(t){const i=this.u_;this.u_=t,this.k_(),i!==this.u_&&(this.n_=!0,this.G_())}m_(){if(!this.n_)return;if(this.n_=!1,this.vi())return void this.J_(ts.Go());const t=this.T_(),i=this.oe/this.u_,s=this.__+t,n=new Gi(s-i+1,s);this.J_(new ts(n))}k_(){const t=this.Q_();if(this.u_<t&&(this.u_=t,this.n_=!0),0!==this.oe){const t=.5*this.oe;this.u_>t&&(this.u_=t,this.n_=!0)}}Q_(){return this.Fi.fixLeftEdge&&this.Fi.fixRightEdge&&0!==this.Qo.length?this.oe/this.Qo.length:this.Fi.minBarSpacing}x_(){const t=this.tu();this.__>t&&(this.__=t,this.n_=!0);const i=this.iu();null!==i&&this.__<i&&(this.__=i,this.n_=!0)}iu(){const t=this.M_(),i=this.Jo;if(null===t||null===i)return null;return t-i-1+(this.Fi.fixLeftEdge?this.oe/this.u_:Math.min(2,this.Qo.length))}tu(){return this.Fi.fixRightEdge?0:this.oe/this.u_-Math.min(2,this.Qo.length)}V_(){this.l_={wn:this.wn(),N_:this.N_()}}F_(){this.l_=null}E_(t){let i=this.i_.get(t.$o);return void 0===i&&(i=new Zi((t=>this.su(t))),this.i_.set(t.$o,i)),i.vo(t)}su(t){const i=function(t,i,s){switch(t){case 0:case 10:return i?s?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return i?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(t.$o,this.Fi.timeVisible,this.Fi.secondsVisible);return void 0!==this.Fi.tickMarkFormatter?this.Fi.tickMarkFormatter(t.Ho,i,this.Zl.locale):function(t,i,s){const n={};switch(i){case 0:n.year="numeric";break;case 1:n.month="short";break;case 2:n.day="numeric";break;case 3:n.hour12=!1,n.hour="2-digit",n.minute="2-digit";break;case 4:n.hour12=!1,n.hour="2-digit",n.minute="2-digit",n.second="2-digit"}const e=void 0===t.Ro?new Date(1e3*t.Eo):new Date(Date.UTC(t.Ro.year,t.Ro.month-1,t.Ro.day));return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()).toLocaleString(s,n)}(t.rt,i,this.Zl.locale)}J_(t){const i=this.s_;this.s_=t,Ji(i.Ko(),this.s_.Ko())||this.e_.m(),Ji(i.Zo(),this.s_.Zo())||this.r_.m(),this.G_()}G_(){this.a_=null}f_(){this.G_(),this.i_.clear()}c_(){const t=this.Zl.dateFormat;this.Fi.timeVisible?this.K_=new Ki({wo:t,bo:this.Fi.secondsVisible?"%h:%m:%s":"%h:%m",Mo:"   ",So:this.Zl.locale}):this.K_=new qi(t,this.Zl.locale)}p_(){if(!this.Fi.fixLeftEdge)return;const t=this.M_();if(null===t)return;const i=this.hn();if(null===i)return;const s=i.Hs()-t;if(s<0){const t=this.__-s-1;this.xs(t)}this.k_()}v_(){this.x_(),this.k_()}}class ls extends O{constructor(t){super(),this.nu=new Map,this.Nt=t}q(t){}X(t){if(!this.Nt.St)return;t.save();let i=0;for(const s of this.Nt.eu){if(0===s.Jt.length)continue;t.font=s.D;const n=this.ru(t,s.Jt);n>this.Nt.Ut?s.B_=this.Nt.Ut/n:s.B_=1,i+=s.hu*s.B_}let s=0;switch(this.Nt.lu){case"top":s=0;break;case"center":s=Math.max((this.Nt.qt-i)/2,0);break;case"bottom":s=Math.max(this.Nt.qt-i,0)}t.fillStyle=this.Nt.O;for(const i of this.Nt.eu){t.save();let n=0;switch(this.Nt.au){case"left":t.textAlign="left",n=i.hu/2;break;case"center":t.textAlign="center",n=this.Nt.Ut/2;break;case"right":t.textAlign="right",n=this.Nt.Ut-1-i.hu/2}t.translate(n,s),t.textBaseline="top",t.font=i.D,t.scale(i.B_,i.B_),t.fillText(i.Jt,0,i.ou),t.restore(),s+=i.hu*i.B_}t.restore()}ru(t,i){const s=this._u(t.font);let n=s.get(i);return void 0===n&&(n=t.measureText(i).width,s.set(i,n)),n}_u(t){let i=this.nu.get(t);return void 0===i&&(i=new Map,this.nu.set(t,i)),i}}class as{constructor(t){this.ut=!0,this.Vt={St:!1,O:"",qt:0,Ut:0,eu:[],lu:"center",au:"center"},this.Ft=new ls(this.Vt),this.zt=t}dt(){this.ut=!0}vt(t,i){return this.ut&&(this.wt(t,i),this.ut=!1),this.Ft}wt(t,i){const s=this.zt.V(),n=this.Vt;n.St=s.visible,n.St&&(n.O=s.color,n.Ut=i,n.qt=t,n.au=s.horzAlign,n.lu=s.vertAlign,n.eu=[{Jt:s.text,D:C(s.fontSize,s.fontFamily,s.fontStyle),hu:1.2*s.fontSize,ou:0,B_:0}])}}class os extends Y{constructor(t,i){super(),this.Fi=i,this.qi=new as(this)}ns(){return[]}ss(){return[this.qi]}V(){return this.Fi}rs(){this.qi.dt()}}!function(t){t[t.OnTouchEnd=0]="OnTouchEnd",t[t.OnNextTap=1]="OnNextTap"}(ss||(ss={}));class _s{constructor(t,i){this.uu=[],this.cu=[],this.oe=0,this.du=null,this.fu=null,this.pu=new m,this.vu=new m,this.mu=null,this.wu=t,this.Fi=i,this.gu=new D(this),this.La=new hs(this,i.timeScale,this.Fi.localization),this.ct=new K(this,i.crosshair),this.bu=new Si(i.crosshair),this.Mu=new os(this,i.watermark),this.Su(),this.uu[0].Ua(2e3),this.yu=this.ku(0),this.xu=this.ku(1)}Rh(){this.Tu(new G(3))}Wr(){this.Tu(new G(2))}Uh(){this.Tu(new G(1))}Eh(t){const i=this.Cu(t);this.Tu(i)}Du(){return this.fu}Pu(t){const i=this.fu;this.fu=t,null!==i&&this.Eh(i.Ou),null!==t&&this.Eh(t.Ou)}V(){return this.Fi}zr(t){w(this.Fi,t),this.uu.forEach((i=>i.Wa(t))),void 0!==t.timeScale&&this.La.zr(t.timeScale),void 0!==t.localization&&this.La.d_(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.pu.m(),this.yu=this.ku(0),this.xu=this.ku(1),this.Rh()}Nu(t,i){if("left"===t)return void this.zr({leftPriceScale:i});if("right"===t)return void this.zr({rightPriceScale:i});const s=this.Ru(t);null!==s&&(s.Tt.zr(i),this.pu.m())}Ru(t){for(const i of this.uu){const s=i.ja(t);if(null!==s)return{Wt:i,Tt:s}}return null}bt(){return this.La}Eu(){return this.uu}Au(){return this.Mu}Lu(){return this.ct}Iu(){return this.vu}Bu(t,i){t.aa(i),this.P_()}qa(t){this.oe=t,this.La.qa(this.oe),this.uu.forEach((i=>i.qa(t))),this.P_()}Su(t){const i=new $i(this.La,this);void 0!==t?this.uu.splice(t,0,i):this.uu.push(i);const s=void 0===t?this.uu.length-1:t,n=new G(3);return n.fs(s,{ps:0,vs:!0}),this.Tu(n),i}io(t,i,s){t.io(i,s)}so(t,i,s){t.so(i,s),this.Ah(),this.Tu(this.Vu(t,2))}no(t,i){t.no(i),this.Tu(this.Vu(t,2))}eo(t,i,s){i.sa()||t.eo(i,s)}ro(t,i,s){i.sa()||(t.ro(i,s),this.Ah(),this.Tu(this.Vu(t,2)))}ho(t,i){i.sa()||(t.ho(i),this.Tu(this.Vu(t,2)))}ao(t,i){t.ao(i),this.Tu(this.Vu(t,2))}Fu(t){this.La.Sa(t)}zu(t,i){const s=this.bt();if(s.vi()||0===i)return;const n=s.Ut();t=Math.max(1,Math.min(t,n)),s.B_(t,i),this.P_()}Wu(t){this.ju(0),this.$u(t),this.Hu()}Uu(t){this.La.ya(t),this.P_()}qu(){this.La.ka(),this.Wr()}ju(t){this.du=t,this.La.xa(t)}$u(t){let i=!1;return null!==this.du&&Math.abs(t-this.du)>20&&(this.du=null,i=!0),this.La.Ta(t),this.P_(),i}Hu(){this.La.Ca(),this.Wr(),this.du=null}ft(){return this.cu}Yu(t,i,s){this.ct.Yi(t,i);let n=NaN,e=this.La.C_(t);const r=this.La.hn();null!==r&&(e=Math.min(Math.max(r.Hs(),e),r.Us()));const h=s.ji(),l=h.yt();null!==l&&(n=h.$i(i,l)),n=this.bu.el(n,e,s),this.ct.Gi(e,n,s),this.Uh(),this.vu.m(this.ct.gt(),{x:t,y:i})}Xu(){this.Lu().Qi(),this.Uh(),this.vu.m(null,null)}Ah(){const t=this.ct.Wt();if(null!==t){const i=this.ct.Ki(),s=this.ct.Zi();this.Yu(i,s,t)}this.ct.rs()}Ku(t,i,s){const n=this.La.Hi(0);void 0!==i&&void 0!==s&&this.La.dt(i,s);const e=this.La.Hi(0),r=this.La.T_(),h=this.La.hn();if(null!==h&&null!==n&&null!==e){const i=h.Ye(r),s=n.Eo>e.Eo,l=null!==t&&t>r&&!s,a=i&&this.La.V().shiftVisibleRangeOnNewBar;if(l&&!a){const i=t-r;this.La.xs(this.La.N_()-i)}}this.La.I_(t)}Bh(t){null!==t&&t._o()}fe(t){const i=this.uu.find((i=>i.va().includes(t)));return void 0===i?null:i}P_(){this.Mu.rs(),this.uu.forEach((t=>t._o())),this.Ah()}M(){this.uu.forEach((t=>t.M())),this.uu.length=0,this.Fi.localization.priceFormatter=void 0,this.Fi.localization.timeFormatter=void 0}Zu(){return this.gu}we(){return this.gu.V()}$a(){return this.pu}Gu(t,i){const s=this.uu[0],n=this.Ju(i,t,s);return this.cu.push(n),1===this.cu.length?this.Rh():this.Wr(),n}Qu(t){const i=this.fe(t),s=this.cu.indexOf(t);e(-1!==s,"Series not found"),this.cu.splice(s,1),h(i).ga(t),t.M&&t.M()}Nh(t,i){const s=h(this.fe(t));s.ga(t);const n=this.Ru(i);if(null===n){const n=t.xi();s.ma(t,i,n)}else{const e=n.Wt===s?t.xi():void 0;n.Wt.ma(t,i,e)}}Y_(){const t=new G(2);t.bs(),this.Tu(t)}tc(t){const i=new G(2);i.Ss(t),this.Tu(i)}ys(){const t=new G(2);t.ys(),this.Tu(t)}ks(t){const i=new G(2);i.ks(t),this.Tu(i)}xs(t){const i=new G(2);i.xs(t),this.Tu(i)}ic(){return this.Fi.rightPriceScale.visible?"right":"left"}sc(){return this.xu}nc(){return this.yu}Pt(t){const i=this.xu,s=this.yu;if(i===s)return i;if(t=Math.max(0,Math.min(100,Math.round(100*t))),null===this.mu||this.mu.zs!==s||this.mu.Ws!==i)this.mu={zs:s,Ws:i,ec:new Map};else{const i=this.mu.ec.get(t);if(void 0!==i)return i}const n=function(t,i,s){const[n,e,r,h]=p(t),[l,a,u,c]=p(i),d=[o(n+s*(l-n)),o(e+s*(a-e)),o(r+s*(u-r)),_(h+s*(c-h))];return`rgba(${d[0]}, ${d[1]}, ${d[2]}, ${d[3]})`}(s,i,t/100);return this.mu.ec.set(t,n),n}Vu(t,i){const s=new G(i);if(null!==t){const n=this.uu.indexOf(t);s.fs(n,{ps:i})}return s}Cu(t,i){return void 0===i&&(i=2),this.Vu(this.fe(t),i)}Tu(t){this.wu&&this.wu(t),this.uu.forEach((t=>t.co().vl().dt()))}Ju(t,i,s){const n=new Mi(this,t,i),e=void 0!==t.priceScaleId?t.priceScaleId:this.ic();return s.ma(n,e),Z(e)||n.zr(t),n}ku(t){const i=this.Fi.layout;return"gradient"===i.background.type?0===t?i.background.topColor:i.background.bottomColor:i.background.color}}function us(t){void 0!==t.borderColor&&(t.borderUpColor=t.borderColor,t.borderDownColor=t.borderColor),void 0!==t.wickColor&&(t.wickUpColor=t.wickColor,t.wickDownColor=t.wickColor)}function cs(t){return!g(t)&&!M(t)}function ds(t){return g(t)}!function(t){t[t.Disabled=0]="Disabled",t[t.Continuous=1]="Continuous",t[t.OnDataUpdate=2]="OnDataUpdate"}(ns||(ns={})),function(t){t[t.LastBar=0]="LastBar",t[t.LastVisible=1]="LastVisible"}(es||(es={})),function(t){t.Solid="solid",t.VerticalGradient="gradient"}(rs||(rs={}));var fs={allowDownsampling:!0};var ps=function(){function t(t,i){var s=this;this._resolutionMediaQueryList=null,this._resolutionListener=function(t){return s._onResolutionChanged()},this._canvasConfiguredListeners=[],this.canvas=t,this._canvasSize={width:this.canvas.clientWidth,height:this.canvas.clientHeight},this._options=i,this._configureCanvas(),this._installResolutionListener()}return t.prototype.destroy=function(){this._canvasConfiguredListeners.length=0,this._uninstallResolutionListener(),this.canvas=null},Object.defineProperty(t.prototype,"canvasSize",{get:function(){return{width:this._canvasSize.width,height:this._canvasSize.height}},enumerable:!0,configurable:!0}),t.prototype.resizeCanvas=function(t){this._canvasSize={width:t.width,height:t.height},this._configureCanvas()},Object.defineProperty(t.prototype,"pixelRatio",{get:function(){var t=this.canvas.ownerDocument.defaultView;if(null==t)throw new Error("No window is associated with the canvas");return t.devicePixelRatio>1||this._options.allowDownsampling?t.devicePixelRatio:1},enumerable:!0,configurable:!0}),t.prototype.subscribeCanvasConfigured=function(t){this._canvasConfiguredListeners.push(t)},t.prototype.unsubscribeCanvasConfigured=function(t){this._canvasConfiguredListeners=this._canvasConfiguredListeners.filter((function(i){return i!=t}))},t.prototype._configureCanvas=function(){var t=this.pixelRatio;this.canvas.style.width=this._canvasSize.width+"px",this.canvas.style.height=this._canvasSize.height+"px",this.canvas.width=this._canvasSize.width*t,this.canvas.height=this._canvasSize.height*t,this._emitCanvasConfigured()},t.prototype._emitCanvasConfigured=function(){var t=this;this._canvasConfiguredListeners.forEach((function(i){return i.call(t)}))},t.prototype._installResolutionListener=function(){if(null!==this._resolutionMediaQueryList)throw new Error("Resolution listener is already installed");var t=this.canvas.ownerDocument.defaultView;if(null==t)throw new Error("No window is associated with the canvas");var i=t.devicePixelRatio;this._resolutionMediaQueryList=t.matchMedia("all and (resolution: "+i+"dppx)"),this._resolutionMediaQueryList.addListener(this._resolutionListener)},t.prototype._uninstallResolutionListener=function(){null!==this._resolutionMediaQueryList&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},t.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},t.prototype._onResolutionChanged=function(){this._configureCanvas(),this._reinstallResolutionListener()},t}();class vs{constructor(t,i){this.At=t,this.Lt=i}Mr(t){return this.At===t.At&&this.Lt===t.Lt}}function ms(t){return t.ownerDocument&&t.ownerDocument.defaultView&&t.ownerDocument.defaultView.devicePixelRatio||1}function ws(t){const i=h(t.getContext("2d"));return i.setTransform(1,0,0,1,0,0),i}function gs(t,i){const s=t.createElement("canvas"),n=ms(s);return s.style.width=`${i.At}px`,s.style.height=`${i.Lt}px`,s.width=i.At*n,s.height=i.Lt*n,s}function bs(t,i){const s=h(t.ownerDocument).createElement("canvas");t.appendChild(s);const n=function(t,i){return void 0===i&&(i=fs),new ps(t,i)}(s,{allowDownsampling:!1});return n.resizeCanvas({width:i.At,height:i.Lt}),n}function Ms(t,i){return t.rc-i.rc}function Ss(t,i,s){const n=(t.rc-i.rc)/(t.rt-i.rt);return Math.sign(n)*Math.min(Math.abs(n),s)}class ys{constructor(t,i,s,n){this.hc=null,this.lc=null,this.ac=null,this.oc=null,this._c=null,this.uc=0,this.cc=0,this.dc=!1,this.fc=t,this.vc=i,this.mc=s,this.Ps=n}wc(t,i){if(null!==this.hc){if(this.hc.rt===i)return void(this.hc.rc=t);if(Math.abs(this.hc.rc-t)<this.Ps)return}this.oc=this.ac,this.ac=this.lc,this.lc=this.hc,this.hc={rt:i,rc:t}}De(t,i){if(null===this.hc||null===this.lc)return;if(i-this.hc.rt>50)return;let s=0;const n=Ss(this.hc,this.lc,this.vc),e=Ms(this.hc,this.lc),r=[n],h=[e];if(s+=e,null!==this.ac){const t=Ss(this.lc,this.ac,this.vc);if(Math.sign(t)===Math.sign(n)){const i=Ms(this.lc,this.ac);if(r.push(t),h.push(i),s+=i,null!==this.oc){const t=Ss(this.ac,this.oc,this.vc);if(Math.sign(t)===Math.sign(n)){const i=Ms(this.ac,this.oc);r.push(t),h.push(i),s+=i}}}}let l=0;for(let t=0;t<r.length;++t)l+=h[t]/s*r[t];Math.abs(l)<this.fc||(this._c={rc:t,rt:i},this.cc=l,this.uc=function(t,i){const s=Math.log(i);return Math.log(1*s/-t)/s}(Math.abs(l),this.mc))}gc(t){const i=h(this._c),s=t-i.rt;return i.rc+this.cc*(Math.pow(this.mc,s)-1)/Math.log(this.mc)}bc(t){return null===this._c||this.Mc(t)===this.uc}Sc(){return this.dc}yc(){this.dc=!0}Mc(t){const i=t-h(this._c).rt;return Math.min(i,this.uc)}}const ks="undefined"!=typeof window;function xs(){return!!ks&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function Ts(){return!!ks&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function Cs(t){ks&&void 0!==window.chrome&&t.addEventListener("mousedown",(t=>{if(1===t.button)return t.preventDefault(),!1}))}class Ds{constructor(t,i,s){this.kc=0,this.xc=null,this.Tc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY},this.Cc=0,this.Dc=null,this.Pc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY},this.Oc=null,this.Nc=!1,this.Rc=null,this.Ec=null,this.Ac=!1,this.Lc=!1,this.Ic=!1,this.Bc=null,this.Vc=null,this.Fc=null,this.zc=null,this.Wc=null,this.jc=null,this.$c=null,this.Hc=0,this.Uc=!1,this.qc=!1,this.Yc=!1,this.Xc=0,this.Kc=null,this.Zc=!Ts(),this.Gc=t=>{this.Jc(t)},this.Qc=t=>{if(this.td(t)){const i=this.sd(t);if(++this.Cc,this.Dc&&this.Cc>1){const{nd:s}=this.ed(Ns(t),this.Pc);s<30&&!this.Ic&&this.rd(i,this.ld.hd),this.ad()}}else{const i=this.sd(t);if(++this.kc,this.xc&&this.kc>1){const{nd:s}=this.ed(Ns(t),this.Tc);s<5&&!this.Lc&&this.od(i,this.ld._d),this.ud()}}},this.dd=t,this.ld=i,this.Fi=s,this.fd()}M(){null!==this.Bc&&(this.Bc(),this.Bc=null),null!==this.Vc&&(this.Vc(),this.Vc=null),null!==this.zc&&(this.zc(),this.zc=null),null!==this.Wc&&(this.Wc(),this.Wc=null),null!==this.jc&&(this.jc(),this.jc=null),null!==this.Fc&&(this.Fc(),this.Fc=null),this.pd(),this.ud()}vd(t){this.zc&&this.zc();const i=this.md.bind(this);if(this.zc=()=>{this.dd.removeEventListener("mousemove",i)},this.dd.addEventListener("mousemove",i),this.td(t))return;const s=this.sd(t);this.od(s,this.ld.wd),this.Zc=!0}ud(){null!==this.xc&&clearTimeout(this.xc),this.kc=0,this.xc=null,this.Tc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY}}ad(){null!==this.Dc&&clearTimeout(this.Dc),this.Cc=0,this.Dc=null,this.Pc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY}}md(t){if(this.Yc||null!==this.Ec)return;if(this.td(t))return;const i=this.sd(t);this.od(i,this.ld.gd),this.Zc=!0}bd(t){const i=Es(t.changedTouches,h(this.Kc));if(null===i)return;if(this.Xc=Rs(t),null!==this.$c)return;if(this.qc)return;this.Uc=!0;const s=this.ed(Ns(i),h(this.Ec)),{Md:n,Sd:e,nd:r}=s;if(this.Ac||!(r<5)){if(!this.Ac){const t=.5*n,i=e>=t&&!this.Fi.yd(),s=t>e&&!this.Fi.kd();i||s||(this.qc=!0),this.Ac=!0,this.Ic=!0,this.pd(),this.ad()}if(!this.qc){const s=this.sd(t,i);this.rd(s,this.ld.xd),Os(t)}}}Td(t){if(0!==t.button)return;const i=this.ed(Ns(t),h(this.Rc)),{nd:s}=i;if(s>=5&&(this.Lc=!0,this.ud()),this.Lc){const i=this.sd(t);this.od(i,this.ld.Cd)}}ed(t,i){const s=Math.abs(i.tt-t.tt),n=Math.abs(i.it-t.it);return{Md:s,Sd:n,nd:s+n}}Dd(t){let i=Es(t.changedTouches,h(this.Kc));if(null===i&&0===t.touches.length&&(i=t.changedTouches[0]),null===i)return;this.Kc=null,this.Xc=Rs(t),this.pd(),this.Ec=null,this.jc&&(this.jc(),this.jc=null);const s=this.sd(t,i);if(this.rd(s,this.ld.Pd),++this.Cc,this.Dc&&this.Cc>1){const{nd:t}=this.ed(Ns(i),this.Pc);t<30&&!this.Ic&&this.rd(s,this.ld.hd),this.ad()}else this.Ic||(this.rd(s,this.ld.Od),this.ld.Od&&Os(t));0===this.Cc&&Os(t),0===t.touches.length&&this.Nc&&(this.Nc=!1,Os(t))}Jc(t){if(0!==t.button)return;const i=this.sd(t);if(this.Rc=null,this.Yc=!1,this.Wc&&(this.Wc(),this.Wc=null),xs()){this.dd.ownerDocument.documentElement.removeEventListener("mouseleave",this.Gc)}if(!this.td(t))if(this.od(i,this.ld.Nd),++this.kc,this.xc&&this.kc>1){const{nd:s}=this.ed(Ns(t),this.Tc);s<5&&!this.Lc&&this.od(i,this.ld._d),this.ud()}else this.Lc||this.od(i,this.ld.Rd)}pd(){null!==this.Oc&&(clearTimeout(this.Oc),this.Oc=null)}Ed(t){if(null!==this.Kc)return;const i=t.changedTouches[0];this.Kc=i.identifier,this.Xc=Rs(t);const s=this.dd.ownerDocument.documentElement;this.Ic=!1,this.Ac=!1,this.qc=!1,this.Ec=Ns(i),this.jc&&(this.jc(),this.jc=null);{const i=this.bd.bind(this),n=this.Dd.bind(this);this.jc=()=>{s.removeEventListener("touchmove",i),s.removeEventListener("touchend",n)},s.addEventListener("touchmove",i,{passive:!1}),s.addEventListener("touchend",n,{passive:!1}),this.pd(),this.Oc=setTimeout(this.Ad.bind(this,t),240)}const n=this.sd(t,i);this.rd(n,this.ld.Ld),this.Dc||(this.Cc=0,this.Dc=setTimeout(this.ad.bind(this),500),this.Pc=Ns(i))}Id(t){if(0!==t.button)return;const i=this.dd.ownerDocument.documentElement;xs()&&i.addEventListener("mouseleave",this.Gc),this.Lc=!1,this.Rc=Ns(t),this.Wc&&(this.Wc(),this.Wc=null);{const t=this.Td.bind(this),s=this.Jc.bind(this);this.Wc=()=>{i.removeEventListener("mousemove",t),i.removeEventListener("mouseup",s)},i.addEventListener("mousemove",t),i.addEventListener("mouseup",s)}if(this.Yc=!0,this.td(t))return;const s=this.sd(t);this.od(s,this.ld.Bd),this.xc||(this.kc=0,this.xc=setTimeout(this.ud.bind(this),500),this.Tc=Ns(t))}fd(){this.dd.addEventListener("mouseenter",this.vd.bind(this)),this.dd.addEventListener("touchcancel",this.pd.bind(this));{const t=this.dd.ownerDocument,i=t=>{this.ld.Vd&&(t.target&&this.dd.contains(t.target)||this.ld.Vd())};this.Vc=()=>{t.removeEventListener("touchstart",i)},this.Bc=()=>{t.removeEventListener("mousedown",i)},t.addEventListener("mousedown",i),t.addEventListener("touchstart",i,{passive:!0})}Ts()&&(this.Fc=()=>{this.dd.removeEventListener("dblclick",this.Qc)},this.dd.addEventListener("dblclick",this.Qc)),this.dd.addEventListener("mouseleave",this.Fd.bind(this)),this.dd.addEventListener("touchstart",this.Ed.bind(this),{passive:!0}),Cs(this.dd),this.dd.addEventListener("mousedown",this.Id.bind(this)),this.zd(),this.dd.addEventListener("touchmove",(()=>{}),{passive:!1})}zd(){void 0===this.ld.Wd&&void 0===this.ld.jd&&void 0===this.ld.$d||(this.dd.addEventListener("touchstart",(t=>this.Hd(t.touches)),{passive:!0}),this.dd.addEventListener("touchmove",(t=>{if(2===t.touches.length&&null!==this.$c&&void 0!==this.ld.jd){const i=Ps(t.touches[0],t.touches[1])/this.Hc;this.ld.jd(this.$c,i),Os(t)}}),{passive:!1}),this.dd.addEventListener("touchend",(t=>{this.Hd(t.touches)})))}Hd(t){1===t.length&&(this.Uc=!1),2!==t.length||this.Uc||this.Nc?this.Ud():this.qd(t)}qd(t){const i=this.dd.getBoundingClientRect()||{left:0,top:0};this.$c={tt:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,it:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this.Hc=Ps(t[0],t[1]),void 0!==this.ld.Wd&&this.ld.Wd(),this.pd()}Ud(){null!==this.$c&&(this.$c=null,void 0!==this.ld.$d&&this.ld.$d())}Fd(t){if(this.zc&&this.zc(),this.td(t))return;if(!this.Zc)return;const i=this.sd(t);this.od(i,this.ld.Yd),this.Zc=!Ts()}Ad(t){const i=Es(t.touches,h(this.Kc));if(null===i)return;const s=this.sd(t,i);this.rd(s,this.ld.Xd),this.Ic=!0,this.Nc=!0}td(t){return t.sourceCapabilities&&void 0!==t.sourceCapabilities.firesTouchEvents?t.sourceCapabilities.firesTouchEvents:Rs(t)<this.Xc+500}rd(t,i){i&&i.call(this.ld,t)}od(t,i){i&&i.call(this.ld,t)}sd(t,i){const s=i||t,n=this.dd.getBoundingClientRect()||{left:0,top:0};return{Kd:s.clientX,Zd:s.clientY,Gd:s.pageX,Jd:s.pageY,Qd:s.screenX,tf:s.screenY,if:s.clientX-n.left,sf:s.clientY-n.top,nf:t.ctrlKey,ef:t.altKey,rf:t.shiftKey,hf:t.metaKey,lf:!t.type.startsWith("mouse")&&"contextmenu"!==t.type&&"click"!==t.type,af:t.type,_f:s.target,uf:t.view,cf:()=>{"touchstart"!==t.type&&Os(t)}}}}function Ps(t,i){const s=t.clientX-i.clientX,n=t.clientY-i.clientY;return Math.sqrt(s*s+n*n)}function Os(t){t.cancelable&&t.preventDefault()}function Ns(t){return{tt:t.pageX,it:t.pageY}}function Rs(t){return t.timeStamp||performance.now()}function Es(t,i){for(let s=0;s<t.length;++s)if(t[s].identifier===i)return t[s];return null}class As{constructor(t,i,s,n){this._e=new Vt(200),this.F=0,this.df="",this.Ke="",this.re=[],this.ff=new Map,this.F=t,this.df=i,this.Ke=C(t,s,n)}M(){this._e.he(),this.re=[],this.ff.clear()}pf(t,i,s,n,e){const r=this.vf(t,i);if("left"!==e){const i=ms(t.canvas);s-=Math.floor(r.mf*i)}n-=Math.floor(r.qt/2),t.drawImage(r.wf,s,n,r.Ut,r.qt)}vf(t,i){let s;if(this.ff.has(i))s=r(this.ff.get(i));else{if(this.re.length>=200){const t=r(this.re.shift());this.ff.delete(t)}const n=ms(t.canvas),e=Math.ceil(this.F/4.5),h=Math.round(this.F/10),l=Math.ceil(this._e.Qt(t,i)),a=xt(Math.round(l+2*e)),o=xt(this.F+2*e),_=gs(document,new vs(a,o));s={Jt:i,mf:Math.round(Math.max(1,l)),Ut:Math.ceil(a*n),qt:Math.ceil(o*n),wf:_},0!==l&&(this.re.push(s.Jt),this.ff.set(s.Jt,s)),V(t=ws(s.wf),n,(()=>{t.font=this.Ke,t.fillStyle=this.df,t.fillText(i,0,o-e-h)}))}return s}}class Ls{constructor(t,i,s,n){this.fi=null,this.gf=null,this.bf=!1,this.Mf=new Vt(50),this.Sf=new As(11,"#000"),this.df=null,this.Ke=null,this.yf=0,this.kf=!1,this.xf=()=>{this.Tf(this.gu.V()),this.kf||this.Pi.Cf().jt().Wr()},this.Df=()=>{this.kf||this.Pi.Cf().jt().Wr()},this.Pi=t,this.Fi=i,this.gu=s,this.Pf="left"===n,this.Of=document.createElement("div"),this.Of.style.height="100%",this.Of.style.overflow="hidden",this.Of.style.width="25px",this.Of.style.left="0",this.Of.style.position="relative",this.Nf=bs(this.Of,new vs(16,16)),this.Nf.subscribeCanvasConfigured(this.xf);const e=this.Nf.canvas;e.style.position="absolute",e.style.zIndex="1",e.style.left="0",e.style.top="0",this.Rf=bs(this.Of,new vs(16,16)),this.Rf.subscribeCanvasConfigured(this.Df);const r=this.Rf.canvas;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0";const h={Bd:this.Ef.bind(this),Ld:this.Ef.bind(this),Cd:this.Af.bind(this),xd:this.Af.bind(this),Vd:this.Lf.bind(this),Nd:this.If.bind(this),Pd:this.If.bind(this),_d:this.Bf.bind(this),hd:this.Bf.bind(this),wd:this.Vf.bind(this),Yd:this.Ff.bind(this)};this.zf=new Ds(this.Rf.canvas,h,{yd:()=>!1,kd:()=>!0})}M(){this.zf.M(),this.Rf.unsubscribeCanvasConfigured(this.Df),this.Rf.destroy(),this.Nf.unsubscribeCanvasConfigured(this.xf),this.Nf.destroy(),null!==this.fi&&this.fi.Ma().v(this),this.fi=null,this.Sf.M()}Wf(){return this.Of}et(){return h(this.fi).V().borderColor}jf(){return this.Fi.textColor}C(){return this.Fi.fontSize}$f(){return C(this.C(),this.Fi.fontFamily)}Hf(){const t=this.gu.V(),i=this.df!==t.O,s=this.Ke!==t.D;return(i||s)&&(this.Tf(t),this.df=t.O),s&&(this.Mf.he(),this.Ke=t.D),t}Uf(){if(null===this.fi)return 0;let t=0;const i=this.Hf(),s=ws(this.Nf.canvas),n=this.fi.pl();s.font=this.$f(),n.length>0&&(t=Math.max(this.Mf.Qt(s,n[0].Pl),this.Mf.Qt(s,n[n.length-1].Pl)));const e=this.qf();for(let i=e.length;i--;){const n=this.Mf.Qt(s,e[i].Jt());n>t&&(t=n)}const r=this.fi.yt();if(null!==r&&null!==this.gf){const i=this.fi.$i(1,r),n=this.fi.$i(this.gf.Lt-2,r);t=Math.max(t,this.Mf.Qt(s,this.fi.mi(Math.floor(Math.min(i,n))+.11111111111111,r)),this.Mf.Qt(s,this.fi.mi(Math.ceil(Math.max(i,n))-.11111111111111,r)))}const h=t||34;let l=Math.ceil(i.k+i.T+i.R+i.A+h);return l+=l%2,l}Yf(t){if(t.At<0||t.Lt<0)throw new Error("Try to set invalid size to PriceAxisWidget "+JSON.stringify(t));null!==this.gf&&this.gf.Mr(t)||(this.gf=t,this.kf=!0,this.Nf.resizeCanvas({width:t.At,height:t.Lt}),this.Rf.resizeCanvas({width:t.At,height:t.Lt}),this.kf=!1,this.Of.style.width=t.At+"px",this.Of.style.height=t.Lt+"px",this.Of.style.minWidth=t.At+"px")}Xf(){return h(this.gf).At}Ci(t){this.fi!==t&&(null!==this.fi&&this.fi.Ma().v(this),this.fi=t,t.Ma().l(this.zl.bind(this),this))}Tt(){return this.fi}he(){const t=this.Pi.Kf();this.Pi.Cf().jt().ao(t,h(this.Tt()))}Zf(t){if(null===this.gf)return;if(1!==t){const t=ws(this.Nf.canvas);this.Gf(),this.Jf(t,this.Nf.pixelRatio),this.Un(t,this.Nf.pixelRatio),this.Qf(t,this.Nf.pixelRatio),this.tp(t,this.Nf.pixelRatio)}const i=ws(this.Rf.canvas),s=this.gf.At,n=this.gf.Lt;V(i,this.Rf.pixelRatio,(()=>{i.clearRect(0,0,s,n)})),this.ip(i,this.Rf.pixelRatio)}sp(){return this.Nf.canvas}dt(){var t;null===(t=this.fi)||void 0===t||t.pl()}Ef(t){if(null===this.fi||this.fi.vi()||!this.Pi.Cf().V().handleScale.axisPressedMouseMove.price)return;const i=this.Pi.Cf().jt(),s=this.Pi.Kf();this.bf=!0,i.io(s,this.fi,t.sf)}Af(t){if(null===this.fi||!this.Pi.Cf().V().handleScale.axisPressedMouseMove.price)return;const i=this.Pi.Cf().jt(),s=this.Pi.Kf(),n=this.fi;i.so(s,n,t.sf)}Lf(){if(null===this.fi||!this.Pi.Cf().V().handleScale.axisPressedMouseMove.price)return;const t=this.Pi.Cf().jt(),i=this.Pi.Kf(),s=this.fi;this.bf&&(this.bf=!1,t.no(i,s))}If(t){if(null===this.fi||!this.Pi.Cf().V().handleScale.axisPressedMouseMove.price)return;const i=this.Pi.Cf().jt(),s=this.Pi.Kf();this.bf=!1,i.no(s,this.fi)}Bf(t){this.Pi.Cf().V().handleScale.axisDoubleClickReset&&this.he()}Vf(t){if(null===this.fi)return;!this.Pi.Cf().jt().V().handleScale.axisPressedMouseMove.price||this.fi.vr()||this.fi.na()||this.np(1)}Ff(t){this.np(0)}qf(){const t=[],i=null===this.fi?void 0:this.fi;return(s=>{for(let n=0;n<s.length;++n){const e=s[n].ns(this.Pi.Kf(),i);for(let i=0;i<e.length;i++)t.push(e[i])}})(this.Pi.Kf().va()),t}Jf(t,i){if(null===this.gf)return;const s=this.gf.At,n=this.gf.Lt;V(t,i,(()=>{const i=this.Pi.Kf().jt(),e=i.nc(),r=i.sc();e===r?F(t,0,0,s,n,e):z(t,0,0,s,n,e,r)}))}Un(t,i){if(null===this.gf||null===this.fi||!this.fi.V().borderVisible)return;t.save(),t.fillStyle=this.et();const s=Math.max(1,Math.floor(this.Hf().k*i));let n;n=this.Pf?Math.floor(this.gf.At*i)-s:0,t.fillRect(n,0,s,Math.ceil(this.gf.Lt*i)),t.restore()}Qf(t,i){if(null===this.gf||null===this.fi)return;const s=this.fi.pl();t.save(),t.strokeStyle=this.et(),t.font=this.$f(),t.fillStyle=this.et();const n=this.Hf(),e=this.fi.V().borderVisible&&this.fi.V().drawTicks,r=this.Pf?Math.floor((this.gf.At-n.T)*i-n.k*i):Math.floor(n.k*i),h=this.Pf?Math.round(r-n.R*i):Math.round(r+n.T*i+n.R*i),l=this.Pf?"right":"left",a=Math.max(1,Math.floor(i)),o=Math.floor(.5*i);if(e){const e=Math.round(n.T*i);t.beginPath();for(const n of s)t.rect(r,Math.round(n._l*i)-o,e,a);t.fill()}t.fillStyle=this.jf();for(const n of s)this.Sf.pf(t,n.Pl,h,Math.round(n._l*i),l);t.restore()}Gf(){if(null===this.gf||null===this.fi)return;let t=this.gf.Lt/2;const i=[],s=this.fi.va().slice(),n=this.Pi.Kf(),e=this.Hf();this.fi===n.ve()&&this.Pi.Kf().va().forEach((t=>{n.pe(t)&&s.push(t)}));const r=this.fi.rl()[0],h=this.fi;s.forEach((s=>{const e=s.ns(n,h);e.forEach((t=>{t.oi(null),t._i()&&i.push(t)})),r===s&&e.length>0&&(t=e[0].ti())}));const l=i.filter((i=>i.ti()<=t)),a=i.filter((i=>i.ti()>t));l.sort(((t,i)=>i.ti()-t.ti())),l.length&&a.length&&a.push(l[0]),a.sort(((t,i)=>t.ti()-i.ti())),i.forEach((t=>t.oi(t.ti())));if(this.fi.V().alignLabels){for(let t=1;t<l.length;t++){const i=l[t],s=l[t-1],n=s.qt(e,!1),r=i.ti(),h=s.ai();r>h-n&&i.oi(h-n)}for(let t=1;t<a.length;t++){const i=a[t],s=a[t-1],n=s.qt(e,!0),r=i.ti(),h=s.ai();r<h+n&&i.oi(h+n)}}}tp(t,i){if(null===this.gf)return;t.save();const s=this.gf,n=this.qf(),e=this.Hf(),r=this.Pf?"right":"left";n.forEach((n=>{if(n.ui()){const l=n.vt(h(this.fi));t.save(),l.U(t,e,this.Mf,s.At,r,i),t.restore()}})),t.restore()}ip(t,i){if(null===this.gf||null===this.fi)return;t.save();const s=this.gf,n=this.Pi.Cf().jt(),e=[],r=this.Pi.Kf(),l=n.Lu().ns(r,this.fi);l.length&&e.push(l);const a=this.Hf(),o=this.Pf?"right":"left";e.forEach((n=>{n.forEach((n=>{t.save(),n.vt(h(this.fi)).U(t,a,this.Mf,s.At,o,i),t.restore()}))})),t.restore()}np(t){this.Of.style.cursor=1===t?"ns-resize":"default"}zl(){const t=this.Uf();this.yf<t&&this.Pi.Cf().jt().Rh(),this.yf=t}Tf(t){this.Sf.M(),this.Sf=new As(t.C,t.O,t.P)}}function Is(t,i,s,n,e){t.Y&&t.Y(i,s,n,e)}function Bs(t,i,s,n,e){t.U(i,s,n,e)}function Vs(t,i){return t.ss(i)}function Fs(t,i){return void 0!==t.Hh?t.Hh(i):[]}class zs{constructor(t,i){this.gf=new vs(0,0),this.ep=null,this.rp=null,this.hp=null,this.lp=!1,this.ap=new m,this.op=0,this._p=!1,this.up=null,this.cp=!1,this.dp=null,this.fp=null,this.kf=!1,this.xf=()=>{this.kf||null===this.pp||this.bi().Wr()},this.Df=()=>{this.kf||null===this.pp||this.bi().Wr()},this.vp=t,this.pp=i,this.pp.uo().l(this.mp.bind(this),this,!0),this.wp=document.createElement("td"),this.wp.style.padding="0",this.wp.style.position="relative";const s=document.createElement("div");s.style.width="100%",s.style.height="100%",s.style.position="relative",s.style.overflow="hidden",this.gp=document.createElement("td"),this.gp.style.padding="0",this.bp=document.createElement("td"),this.bp.style.padding="0",this.wp.appendChild(s),this.Nf=bs(s,new vs(16,16)),this.Nf.subscribeCanvasConfigured(this.xf);const n=this.Nf.canvas;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this.Rf=bs(s,new vs(16,16)),this.Rf.subscribeCanvasConfigured(this.Df);const e=this.Rf.canvas;e.style.position="absolute",e.style.zIndex="2",e.style.left="0",e.style.top="0",this.Mp=document.createElement("tr"),this.Mp.appendChild(this.gp),this.Mp.appendChild(this.wp),this.Mp.appendChild(this.bp),this.Sp(),this.zf=new Ds(this.Rf.canvas,this,{yd:()=>null===this.up&&!this.vp.V().handleScroll.vertTouchDrag,kd:()=>null===this.up&&!this.vp.V().handleScroll.horzTouchDrag})}M(){null!==this.ep&&this.ep.M(),null!==this.rp&&this.rp.M(),this.Rf.unsubscribeCanvasConfigured(this.Df),this.Rf.destroy(),this.Nf.unsubscribeCanvasConfigured(this.xf),this.Nf.destroy(),null!==this.pp&&this.pp.uo().v(this),this.zf.M()}Kf(){return h(this.pp)}yp(t){null!==this.pp&&this.pp.uo().v(this),this.pp=t,null!==this.pp&&this.pp.uo().l(zs.prototype.mp.bind(this),this,!0),this.Sp()}Cf(){return this.vp}Wf(){return this.Mp}Sp(){if(null!==this.pp&&(this.kp(),0!==this.bi().ft().length)){if(null!==this.ep){const t=this.pp.Ja();this.ep.Ci(h(t))}if(null!==this.rp){const t=this.pp.Qa();this.rp.Ci(h(t))}}}xp(){null!==this.ep&&this.ep.dt(),null!==this.rp&&this.rp.dt()}Ha(){return null!==this.pp?this.pp.Ha():0}Ua(t){this.pp&&this.pp.Ua(t)}wd(t){if(!this.pp)return;this.Tp();const i=t.if,s=t.sf;this.Cp(i,s)}Bd(t){this.Tp(),this.Dp(),this.Cp(t.if,t.sf)}gd(t){if(!this.pp)return;this.Tp();const i=t.if,s=t.sf;this.Cp(i,s);const n=this.Ze(i,s);this.bi().Pu(n&&{Ou:n.Ou,Pp:n.Pp})}Rd(t){if(null===this.pp)return;this.Tp();const i=t.if,s=t.sf;if(this.ap.g()){const t=this.bi().Lu().gt();this.ap.m(t,{x:i,y:s})}}Cd(t){this.Tp(),this.Op(t),this.Cp(t.if,t.sf)}Nd(t){null!==this.pp&&(this.Tp(),this._p=!1,this.Np(t))}Xd(t){if(this._p=!0,null===this.up){const i={x:t.if,y:t.sf};this.Rp(i,i)}}Yd(t){null!==this.pp&&(this.Tp(),this.pp.jt().Pu(null),this.Ep())}Ap(){return this.ap}Wd(){this.op=1,this.Lp()}jd(t,i){if(!this.vp.V().handleScale.pinch)return;const s=5*(i-this.op);this.op=i,this.bi().zu(t.tt,s)}Ld(t){if(this._p=!1,this.cp=null!==this.up,this.Dp(),null!==this.up){const i=this.bi().Lu();this.dp={x:i.Yt(),y:i.Xt()},this.up={x:t.if,y:t.sf}}}xd(t){if(null===this.pp)return;const i=t.if,s=t.sf;if(null===this.up)this.Op(t);else{this.cp=!1;const t=h(this.dp),n=t.x+(i-this.up.x),e=t.y+(s-this.up.y);this.Cp(n,e)}}Pd(t){0===this.Cf().V().trackingMode.exitMode&&(this.cp=!0),this.Ip(),this.Np(t)}Ze(t,i){const s=this.pp;if(null===s)return null;const n=s.va();for(const e of n){const n=this.Bp(e.ss(s),t,i);if(null!==n)return{Ou:e,uf:n.uf,Pp:n.Pp}}return null}Vp(t,i){h("left"===i?this.ep:this.rp).Yf(new vs(t,this.gf.Lt))}Fp(){return this.gf}Yf(t){if(t.At<0||t.Lt<0)throw new Error("Try to set invalid size to PaneWidget "+JSON.stringify(t));this.gf.Mr(t)||(this.gf=t,this.kf=!0,this.Nf.resizeCanvas({width:t.At,height:t.Lt}),this.Rf.resizeCanvas({width:t.At,height:t.Lt}),this.kf=!1,this.wp.style.width=t.At+"px",this.wp.style.height=t.Lt+"px")}zp(){const t=h(this.pp);t.Ga(t.Ja()),t.Ga(t.Qa());for(const i of t.rl())if(t.pe(i)){const s=i.Tt();null!==s&&t.Ga(s),i.rs()}}sp(){return this.Nf.canvas}Zf(t){if(0===t)return;if(null===this.pp)return;if(t>1&&this.zp(),null!==this.ep&&this.ep.Zf(t),null!==this.rp&&this.rp.Zf(t),1!==t){const t=ws(this.Nf.canvas);t.save(),this.Jf(t,this.Nf.pixelRatio),this.pp&&(this.Wp(t,this.Nf.pixelRatio),this.jp(t,this.Nf.pixelRatio),this.$p(t,this.Nf.pixelRatio,Vs)),t.restore()}const i=ws(this.Rf.canvas);i.clearRect(0,0,Math.ceil(this.gf.At*this.Rf.pixelRatio),Math.ceil(this.gf.Lt*this.Rf.pixelRatio)),this.$p(i,this.Nf.pixelRatio,Fs),this.Hp(i,this.Rf.pixelRatio)}Up(){return this.ep}qp(){return this.rp}mp(){null!==this.pp&&this.pp.uo().v(this),this.pp=null}Jf(t,i){V(t,i,(()=>{const i=this.bi(),s=i.nc(),n=i.sc();s===n?F(t,0,0,this.gf.At,this.gf.Lt,n):z(t,0,0,this.gf.At,this.gf.Lt,s,n)}))}Wp(t,i){const s=h(this.pp),n=s.co().vl().vt(s.qt(),s.Ut());null!==n&&(t.save(),n.U(t,i,!1),t.restore())}jp(t,i){const s=this.bi().Au();this.Yp(t,i,Vs,Is,s),this.Yp(t,i,Vs,Bs,s)}Hp(t,i){this.Yp(t,i,Vs,Bs,this.bi().Lu())}$p(t,i,s){const n=h(this.pp).va();for(const e of n)this.Yp(t,i,s,Is,e);for(const e of n)this.Yp(t,i,s,Bs,e)}Yp(t,i,s,n,e){const r=h(this.pp),l=s(e,r),a=r.qt(),o=r.Ut(),_=r.jt().Du(),u=null!==_&&_.Ou===e,c=null!==_&&u&&void 0!==_.Pp?_.Pp.Ge:void 0;for(const s of l){const e=s.vt(a,o);null!==e&&(t.save(),n(e,t,i,u,c),t.restore())}}Bp(t,i,s){for(const n of t){const t=n.vt(this.gf.Lt,this.gf.At);if(null!==t&&t.Ze){const e=t.Ze(i,s);if(null!==e)return{uf:n,Pp:e}}}return null}kp(){if(null===this.pp)return;const t=this.vp,i=this.pp.Ja().V().visible,s=this.pp.Qa().V().visible;i||null===this.ep||(this.gp.removeChild(this.ep.Wf()),this.ep.M(),this.ep=null),s||null===this.rp||(this.bp.removeChild(this.rp.Wf()),this.rp.M(),this.rp=null);const n=t.jt().Zu();i&&null===this.ep&&(this.ep=new Ls(this,t.V().layout,n,"left"),this.gp.appendChild(this.ep.Wf())),s&&null===this.rp&&(this.rp=new Ls(this,t.V().layout,n,"right"),this.bp.appendChild(this.rp.Wf()))}Xp(t){return t.lf&&this._p||null!==this.up}Kp(t){return Math.max(0,Math.min(t,this.gf.At-1))}Zp(t){return Math.max(0,Math.min(t,this.gf.Lt-1))}Cp(t,i){this.bi().Yu(this.Kp(t),this.Zp(i),h(this.pp))}Ep(){this.bi().Xu()}Ip(){this.cp&&(this.up=null,this.Ep())}Rp(t,i){this.up=t,this.cp=!1,this.Cp(i.x,i.y);const s=this.bi().Lu();this.dp={x:s.Yt(),y:s.Xt()}}bi(){return this.vp.jt()}Gp(){const t=this.bi(),i=this.Kf(),s=i.ji();t.ho(i,s),t.Hu(),this.hp=null,this.lp=!1}Np(t){if(!this.lp)return;const i=performance.now();if(null!==this.fp&&this.fp.De(t.if,i),null===this.fp||this.fp.bc(i))return void this.Gp();const s=this.bi(),n=s.bt(),e=this.fp,r=()=>{if(e.Sc())return;const t=performance.now();let i=e.bc(t);if(!e.Sc()){const r=n.N_();s.$u(e.gc(t)),r===n.N_()&&(i=!0,this.fp=null)}i?this.Gp():requestAnimationFrame(r)};requestAnimationFrame(r)}Tp(){this.up=null}Dp(){if(!this.pp)return;if(this.Lp(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)h(document.activeElement).blur();else{const t=document.getSelection();null!==t&&t.removeAllRanges()}!this.pp.ji().vi()&&this.bi().bt().vi()}Op(t){if(null===this.pp)return;const i=this.bi();if(i.bt().vi())return;const s=this.vp.V(),n=s.handleScroll,e=s.kineticScroll;if((!n.pressedMouseMove||t.lf)&&(!n.horzTouchDrag&&!n.vertTouchDrag||!t.lf))return;const r=this.pp.ji(),h=performance.now();null!==this.hp||this.Xp(t)||(this.hp={x:t.Kd,y:t.Zd,Eo:h,if:t.if,sf:t.sf}),null!==this.fp&&this.fp.wc(t.if,h),null===this.hp||this.lp||this.hp.x===t.Kd&&this.hp.y===t.Zd||(null===this.fp&&(t.lf&&e.touch||!t.lf&&e.mouse)&&(this.fp=new ys(.2,7,.997,15),this.fp.wc(this.hp.if,this.hp.Eo),this.fp.wc(t.if,h)),r.vi()||i.eo(this.pp,r,t.sf),i.ju(t.if),this.lp=!0),this.lp&&(r.vi()||i.ro(this.pp,r,t.sf),i.$u(t.if))}Lp(){const t=performance.now(),i=null===this.fp||this.fp.bc(t);null!==this.fp&&(i||this.Gp()),null!==this.fp&&(this.fp.yc(),this.fp=null)}}class Ws{constructor(t,i,s,n,e){this.ut=!0,this.gf=new vs(0,0),this.xf=()=>this.Zf(3),this.Pf="left"===t,this.gu=s.Zu,this.Fi=i,this.Jp=n,this.Qp=e,this.Of=document.createElement("div"),this.Of.style.width="25px",this.Of.style.height="100%",this.Of.style.overflow="hidden",this.Nf=bs(this.Of,new vs(16,16)),this.Nf.subscribeCanvasConfigured(this.xf)}M(){this.Nf.unsubscribeCanvasConfigured(this.xf),this.Nf.destroy()}Wf(){return this.Of}Fp(){return this.gf}Yf(t){if(t.At<0||t.Lt<0)throw new Error("Try to set invalid size to PriceAxisStub "+JSON.stringify(t));this.gf.Mr(t)||(this.gf=t,this.Nf.resizeCanvas({width:t.At,height:t.Lt}),this.Of.style.width=`${t.At}px`,this.Of.style.minWidth=`${t.At}px`,this.Of.style.height=`${t.Lt}px`,this.ut=!0)}Zf(t){if(t<3&&!this.ut)return;if(0===this.gf.At||0===this.gf.Lt)return;this.ut=!1;const i=ws(this.Nf.canvas);this.Jf(i,this.Nf.pixelRatio),this.Un(i,this.Nf.pixelRatio)}sp(){return this.Nf.canvas}Un(t,i){if(!this.Jp())return;const s=this.gf.At;t.save(),t.fillStyle=this.Fi.timeScale.borderColor;const n=Math.floor(this.gu.V().k*i),e=this.Pf?Math.round(s*i)-n:0;t.fillRect(e,0,n,n),t.restore()}Jf(t,i){V(t,i,(()=>{F(t,0,0,this.gf.At,this.gf.Lt,this.Qp())}))}}function js(t,i){return t.$o>i.$o?t:i}class $s{constructor(t){this.tv=null,this.iv=null,this.S=null,this.sv=!1,this.gf=new vs(0,0),this.nv=new m,this.Mf=new Vt(5),this.kf=!1,this.xf=()=>{this.kf||this.vp.jt().Wr()},this.Df=()=>{this.kf||this.vp.jt().Wr()},this.vp=t,this.Fi=t.V().layout,this.ev=document.createElement("tr"),this.rv=document.createElement("td"),this.rv.style.padding="0",this.hv=document.createElement("td"),this.hv.style.padding="0",this.Of=document.createElement("td"),this.Of.style.height="25px",this.Of.style.padding="0",this.lv=document.createElement("div"),this.lv.style.width="100%",this.lv.style.height="100%",this.lv.style.position="relative",this.lv.style.overflow="hidden",this.Of.appendChild(this.lv),this.Nf=bs(this.lv,new vs(16,16)),this.Nf.subscribeCanvasConfigured(this.xf);const i=this.Nf.canvas;i.style.position="absolute",i.style.zIndex="1",i.style.left="0",i.style.top="0",this.Rf=bs(this.lv,new vs(16,16)),this.Rf.subscribeCanvasConfigured(this.Df);const s=this.Rf.canvas;s.style.position="absolute",s.style.zIndex="2",s.style.left="0",s.style.top="0",this.ev.appendChild(this.rv),this.ev.appendChild(this.Of),this.ev.appendChild(this.hv),this.av(),this.vp.jt().$a().l(this.av.bind(this),this),this.zf=new Ds(this.Rf.canvas,this,{yd:()=>!0,kd:()=>!1})}M(){this.zf.M(),null!==this.tv&&this.tv.M(),null!==this.iv&&this.iv.M(),this.Rf.unsubscribeCanvasConfigured(this.Df),this.Rf.destroy(),this.Nf.unsubscribeCanvasConfigured(this.xf),this.Nf.destroy()}Wf(){return this.ev}ov(){return this.tv}_v(){return this.iv}Bd(t){if(this.sv)return;this.sv=!0;const i=this.vp.jt();!i.bt().vi()&&this.vp.V().handleScale.axisPressedMouseMove.time&&i.Fu(t.if)}Ld(t){this.Bd(t)}Vd(){const t=this.vp.jt();!t.bt().vi()&&this.sv&&(this.sv=!1,this.vp.V().handleScale.axisPressedMouseMove.time&&t.qu())}Cd(t){const i=this.vp.jt();!i.bt().vi()&&this.vp.V().handleScale.axisPressedMouseMove.time&&i.Uu(t.if)}xd(t){this.Cd(t)}Nd(){this.sv=!1;const t=this.vp.jt();t.bt().vi()&&!this.vp.V().handleScale.axisPressedMouseMove.time||t.qu()}Pd(){this.Nd()}_d(){this.vp.V().handleScale.axisDoubleClickReset&&this.vp.jt().ys()}hd(){this._d()}wd(){this.vp.jt().V().handleScale.axisPressedMouseMove.time&&this.np(1)}Yd(){this.np(0)}Fp(){return this.gf}uv(){return this.nv}cv(t,i,s){this.gf&&this.gf.Mr(t)||(this.gf=t,this.kf=!0,this.Nf.resizeCanvas({width:t.At,height:t.Lt}),this.Rf.resizeCanvas({width:t.At,height:t.Lt}),this.kf=!1,this.Of.style.width=t.At+"px",this.Of.style.height=t.Lt+"px",this.nv.m(t)),null!==this.tv&&this.tv.Yf(new vs(i,t.Lt)),null!==this.iv&&this.iv.Yf(new vs(s,t.Lt))}dv(){const t=this.fv();return Math.ceil(t.k+t.T+t.C+t.L+t.N)}dt(){this.vp.jt().bt().pl()}sp(){return this.Nf.canvas}Zf(t){if(0===t)return;if(1!==t){const i=ws(this.Nf.canvas);this.Jf(i,this.Nf.pixelRatio),this.Un(i,this.Nf.pixelRatio),this.Qf(i,this.Nf.pixelRatio),null!==this.tv&&this.tv.Zf(t),null!==this.iv&&this.iv.Zf(t)}const i=ws(this.Rf.canvas),s=this.Rf.pixelRatio;i.clearRect(0,0,Math.ceil(this.gf.At*s),Math.ceil(this.gf.Lt*s)),this.pv([this.vp.jt().Lu()],i,s)}Jf(t,i){V(t,i,(()=>{F(t,0,0,this.gf.At,this.gf.Lt,this.vp.jt().sc())}))}Un(t,i){if(this.vp.V().timeScale.borderVisible){t.save(),t.fillStyle=this.vv();const s=Math.max(1,Math.floor(this.fv().k*i));t.fillRect(0,0,Math.ceil(this.gf.At*i),s),t.restore()}}Qf(t,i){const s=this.vp.jt().bt().pl();if(!s||0===s.length)return;let n=s.reduce(js,s[0]).$o;n>30&&n<50&&(n=30),t.save(),t.strokeStyle=this.vv();const e=this.fv(),r=e.k+e.T+e.L+e.C-e.I;t.textAlign="center",t.fillStyle=this.vv();const h=Math.floor(this.fv().k*i),l=Math.max(1,Math.floor(i)),a=Math.floor(.5*i);if(this.vp.jt().bt().V().borderVisible){t.beginPath();const n=Math.round(e.T*i);for(let e=s.length;e--;){const r=Math.round(s[e]._l*i);t.rect(r-a,h,l,n)}t.fill()}t.fillStyle=this.j(),V(t,i,(()=>{t.font=this.mv();for(const i of s)if(i.$o<n){const s=i.A_?this.wv(t,i._l,i.Pl):i._l;t.fillText(i.Pl,s,r)}t.font=this.gv();for(const i of s)if(i.$o>=n){const s=i.A_?this.wv(t,i._l,i.Pl):i._l;t.fillText(i.Pl,s,r)}})),t.restore()}wv(t,i,s){const n=this.Mf.Qt(t,s),e=n/2,r=Math.floor(i-e)+.5;return r<0?i+=Math.abs(0-r):r+n>this.gf.At&&(i-=Math.abs(this.gf.At-(r+n))),i}pv(t,i,s){const n=this.fv();for(const e of t)for(const t of e.Di())i.save(),t.vt().U(i,n,s),i.restore()}vv(){return this.vp.V().timeScale.borderColor}j(){return this.Fi.textColor}F(){return this.Fi.fontSize}mv(){return C(this.F(),this.Fi.fontFamily)}gv(){return C(this.F(),this.Fi.fontFamily,"bold")}fv(){null===this.S&&(this.S={k:1,I:NaN,L:NaN,N:NaN,gi:NaN,T:3,C:NaN,D:"",wi:new Vt});const t=this.S,i=this.mv();if(t.D!==i){const s=this.F();t.C=s,t.D=i,t.L=Math.ceil(s/2.5),t.N=t.L,t.gi=Math.ceil(s/2),t.I=Math.round(this.F()/5),t.wi.he()}return this.S}np(t){this.Of.style.cursor=1===t?"ew-resize":"default"}av(){const t=this.vp.jt(),i=t.V();i.leftPriceScale.visible||null===this.tv||(this.rv.removeChild(this.tv.Wf()),this.tv.M(),this.tv=null),i.rightPriceScale.visible||null===this.iv||(this.hv.removeChild(this.iv.Wf()),this.iv.M(),this.iv=null);const s={Zu:this.vp.jt().Zu()},n=()=>i.leftPriceScale.borderVisible&&t.bt().V().borderVisible,e=()=>t.sc();i.leftPriceScale.visible&&null===this.tv&&(this.tv=new Ws("left",i,s,n,e),this.rv.appendChild(this.tv.Wf())),i.rightPriceScale.visible&&null===this.iv&&(this.iv=new Ws("right",i,s,n,e),this.hv.appendChild(this.iv.Wf()))}}class Hs{constructor(t,i){var s;this.bv=[],this.Mv=0,this.Rl=0,this.oe=0,this.Sv=0,this.yv=0,this.kv=null,this.xv=!1,this.ap=new m,this.vu=new m,this.Fi=i,this.ev=document.createElement("div"),this.ev.classList.add("tv-lightweight-charts"),this.ev.style.overflow="hidden",this.ev.style.width="100%",this.ev.style.height="100%",(s=this.ev).style.userSelect="none",s.style.webkitUserSelect="none",s.style.msUserSelect="none",s.style.MozUserSelect="none",s.style.webkitTapHighlightColor="transparent",this.Tv=document.createElement("table"),this.Tv.setAttribute("cellspacing","0"),this.ev.appendChild(this.Tv),this.Cv=this.Dv.bind(this),this.ev.addEventListener("wheel",this.Cv,{passive:!1}),this.bi=new _s(this.wu.bind(this),this.Fi),this.jt().Iu().l(this.Pv.bind(this),this),this.Ov=new $s(this),this.Tv.appendChild(this.Ov.Wf());let n=this.Fi.width,e=this.Fi.height;if(0===n||0===e){const i=t.getBoundingClientRect();0===n&&(n=Math.floor(i.width),n-=n%2),0===e&&(e=Math.floor(i.height),e-=e%2)}this.Nv(n,e),this.Rv(),t.appendChild(this.ev),this.Ev(),this.bi.bt().U_().l(this.bi.Rh.bind(this.bi),this),this.bi.$a().l(this.bi.Rh.bind(this.bi),this)}jt(){return this.bi}V(){return this.Fi}Av(){return this.bv}Lv(){return this.Ov}M(){this.ev.removeEventListener("wheel",this.Cv),0!==this.Mv&&window.cancelAnimationFrame(this.Mv),this.bi.Iu().v(this),this.bi.bt().U_().v(this),this.bi.$a().v(this),this.bi.M();for(const t of this.bv)this.Tv.removeChild(t.Wf()),t.Ap().v(this),t.M();this.bv=[],h(this.Ov).M(),null!==this.ev.parentElement&&this.ev.parentElement.removeChild(this.ev),this.vu.M(),this.ap.M()}Nv(t,i,s=!1){if(this.Rl===i&&this.oe===t)return;this.Rl=i,this.oe=t;const n=i+"px",e=t+"px";h(this.ev).style.height=n,h(this.ev).style.width=e,this.Tv.style.height=n,this.Tv.style.width=e,s?this.Iv(new G(3)):this.bi.Rh()}Zf(t){void 0===t&&(t=new G(3));for(let i=0;i<this.bv.length;i++)this.bv[i].Zf(t.gs(i).ps);this.Fi.timeScale.visible&&this.Ov.Zf(t.ws())}zr(t){this.bi.zr(t),this.Ev();const i=t.width||this.oe,s=t.height||this.Rl;this.Nv(i,s)}Ap(){return this.ap}Iu(){return this.vu}Bv(){null!==this.kv&&(this.Iv(this.kv),this.kv=null);const t=this.bv[0],i=gs(document,new vs(this.oe,this.Rl)),s=ws(i),n=ms(i);return V(s,n,(()=>{let i=0,n=0;const e=t=>{for(let e=0;e<this.bv.length;e++){const r=this.bv[e],l=r.Fp().Lt,a=h("left"===t?r.Up():r.qp()),o=a.sp();s.drawImage(o,i,n,a.Xf(),l),n+=l}};this.Vv()&&(e("left"),i=h(t.Up()).Xf()),n=0;for(let t=0;t<this.bv.length;t++){const e=this.bv[t],r=e.Fp(),h=e.sp();s.drawImage(h,i,n,r.At,r.Lt),n+=r.Lt}i+=t.Fp().At,this.Fv()&&(n=0,e("right"));const r=t=>{const e=h("left"===t?this.Ov.ov():this.Ov._v()),r=e.Fp(),l=e.sp();s.drawImage(l,i,n,r.At,r.Lt)};if(this.Fi.timeScale.visible){i=0,this.Vv()&&(r("left"),i=h(t.Up()).Xf());const e=this.Ov.Fp(),l=this.Ov.sp();s.drawImage(l,i,n,e.At,e.Lt),this.Fv()&&(i+=t.Fp().At,r("right"),s.restore())}})),i}zv(t){if("left"===t&&!this.Vv())return 0;if("right"===t&&!this.Fv())return 0;if(0===this.bv.length)return 0;return h("left"===t?this.bv[0].Up():this.bv[0].qp()).Xf()}Wv(){let t=0,i=0,s=0;for(const n of this.bv)this.Vv()&&(i=Math.max(i,h(n.Up()).Uf())),this.Fv()&&(s=Math.max(s,h(n.qp()).Uf())),t+=n.Ha();const n=this.oe,e=this.Rl,r=Math.max(n-i-s,0),l=this.Fi.timeScale.visible;let a=l?this.Ov.dv():0;a%2&&(a+=1);const o=0+a,_=e<o?0:e-o,u=_/t;let c=0;for(let t=0;t<this.bv.length;++t){const n=this.bv[t];n.yp(this.bi.Eu()[t]);let e=0,h=0;h=t===this.bv.length-1?_-c:Math.round(n.Ha()*u),e=Math.max(h,2),c+=e,n.Yf(new vs(r,e)),this.Vv()&&n.Vp(i,"left"),this.Fv()&&n.Vp(s,"right"),n.Kf()&&this.bi.Bu(n.Kf(),e)}this.Ov.cv(new vs(l?r:0,a),l?i:0,l?s:0),this.bi.qa(r),this.Sv!==i&&(this.Sv=i),this.yv!==s&&(this.yv=s)}Dv(t){let i=t.deltaX/100,s=-t.deltaY/100;if(0!==i&&this.Fi.handleScroll.mouseWheel||0!==s&&this.Fi.handleScale.mouseWheel){switch(t.cancelable&&t.preventDefault(),t.deltaMode){case t.DOM_DELTA_PAGE:i*=120,s*=120;break;case t.DOM_DELTA_LINE:i*=32,s*=32}if(0!==s&&this.Fi.handleScale.mouseWheel){const i=Math.sign(s)*Math.min(1,Math.abs(s)),n=t.clientX-this.ev.getBoundingClientRect().left;this.jt().zu(n,i)}0!==i&&this.Fi.handleScroll.mouseWheel&&this.jt().Wu(-80*i)}}Iv(t){var i;const s=t.ws();3===s&&this.jv(),3!==s&&2!==s||(this.$v(t),this.Hv(t),this.Ov.dt(),this.bv.forEach((t=>{t.xp()})),3===(null===(i=this.kv)||void 0===i?void 0:i.ws())&&(this.kv.Cs(t),this.jv(),this.$v(this.kv),this.Hv(this.kv),t=this.kv,this.kv=null)),this.Zf(t)}Hv(t){const i=t.Ts();for(const t of i)this.Ds(t)}$v(t){const i=this.bi.Eu();for(let s=0;s<i.length;s++)t.gs(s).vs&&i[s].oo()}Ds(t){const i=this.bi.bt();switch(t.Ms){case 0:i.Y_();break;case 1:i.X_(t.Ct);break;case 2:i.ks(t.Ct);break;case 3:i.xs(t.Ct);break;case 4:i.L_()}}wu(t){null!==this.kv?this.kv.Cs(t):this.kv=t,this.xv||(this.xv=!0,this.Mv=window.requestAnimationFrame((()=>{if(this.xv=!1,this.Mv=0,null!==this.kv){const t=this.kv;this.kv=null,this.Iv(t)}})))}jv(){this.Rv()}Rv(){const t=this.bi.Eu(),i=t.length,s=this.bv.length;for(let t=i;t<s;t++){const t=r(this.bv.pop());this.Tv.removeChild(t.Wf()),t.Ap().v(this),t.M()}for(let n=s;n<i;n++){const i=new zs(this,t[n]);i.Ap().l(this.Uv.bind(this),this),this.bv.push(i),this.Tv.insertBefore(i.Wf(),this.Ov.Wf())}for(let s=0;s<i;s++){const i=t[s],n=this.bv[s];n.Kf()!==i?n.yp(i):n.Sp()}this.Ev(),this.Wv()}qv(t,i){var s;const n=new Map;if(null!==t){this.bi.ft().forEach((i=>{const s=i._s().rh(t);null!==s&&n.set(i,s)}))}let e;if(null!==t){const i=null===(s=this.bi.bt().Mi(t))||void 0===s?void 0:s.Ho;void 0!==i&&(e=i)}const r=this.jt().Du(),h=null!==r&&r.Ou instanceof Mi?r.Ou:void 0,l=null!==r&&void 0!==r.Pp?r.Pp.Qe:void 0;return{rt:e,pn:null!=t?t:void 0,Yv:null!=i?i:void 0,Xv:h,Kv:n,Zv:l}}Uv(t,i){this.ap.m((()=>this.qv(t,i)))}Pv(t,i){this.vu.m((()=>this.qv(t,i)))}Ev(){const t=this.Fi.timeScale.visible?"":"none";this.Ov.Wf().style.display=t}Vv(){return this.bv[0].Kf().Ja().V().visible}Fv(){return this.bv[0].Kf().Qa().V().visible}}function Us(t,i,s,n){const e=s.value;return{pn:i,rt:t,Ct:[e,e,e,e],Ho:n}}function qs(t,i,s,n){const e=s.value,r={pn:i,rt:t,Ct:[e,e,e,e],Ho:n};return"color"in s&&void 0!==s.color&&(r.O=s.color),r}function Ys(t){return void 0!==t.Ct}function Xs(t){return(i,s,n,e)=>{return void 0===(r=n).open&&void 0===r.value?{rt:i,pn:s,Ho:e}:t(i,s,n,e);var r}}const Ks={Candlestick:Xs((function(t,i,s,n){const e={pn:i,rt:t,Ct:[s.open,s.high,s.low,s.close],Ho:n};return"color"in s&&void 0!==s.color&&(e.O=s.color),"borderColor"in s&&void 0!==s.borderColor&&(e.Dt=s.borderColor),"wickColor"in s&&void 0!==s.wickColor&&(e.Xn=s.wickColor),e})),Bar:Xs((function(t,i,s,n){const e={pn:i,rt:t,Ct:[s.open,s.high,s.low,s.close],Ho:n};return"color"in s&&void 0!==s.color&&(e.O=s.color),e})),Area:Xs(Us),Baseline:Xs(Us),Histogram:Xs(qs),Line:Xs(qs)};function Zs(t){return Ks[t]}function Gs(t){return 60*t*60*1e3}function Js(t){return 60*t*1e3}const Qs=[{Gv:(tn=1,1e3*tn),$o:10},{Gv:Js(1),$o:20},{Gv:Js(5),$o:21},{Gv:Js(30),$o:22},{Gv:Gs(1),$o:30},{Gv:Gs(3),$o:31},{Gv:Gs(6),$o:32},{Gv:Gs(12),$o:33}];var tn;function sn(t,i){if(t.getUTCFullYear()!==i.getUTCFullYear())return 70;if(t.getUTCMonth()!==i.getUTCMonth())return 60;if(t.getUTCDate()!==i.getUTCDate())return 50;for(let s=Qs.length-1;s>=0;--s)if(Math.floor(i.getTime()/Qs[s].Gv)!==Math.floor(t.getTime()/Qs[s].Gv))return Qs[s].$o;return 0}function nn(t,i=0){if(0===t.length)return;let s=0===i?null:t[i-1].rt.Eo,n=null!==s?new Date(1e3*s):null,e=0;for(let r=i;r<t.length;++r){const i=t[r],h=new Date(1e3*i.rt.Eo);null!==n&&(i.jo=sn(h,n)),e+=i.rt.Eo-(s||i.rt.Eo),s=i.rt.Eo,n=h}if(0===i&&t.length>1){const i=Math.ceil(e/(t.length-1)),s=new Date(1e3*(t[0].rt.Eo-i));t[0].jo=sn(new Date(1e3*t[0].rt.Eo),s)}}function en(t){if(!cs(t))throw new Error("time must be of type BusinessDay");const i=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{Eo:Math.round(i.getTime()/1e3),Ro:t}}function rn(t){if(!ds(t))throw new Error("time must be of type isUTCTimestamp");return{Eo:t}}function hn(t){return 0===t.length?null:cs(t[0].time)?en:rn}function ln(t){return ds(t)?rn(t):cs(t)?en(t):en(an(t))}function an(t){const i=new Date(t);if(isNaN(i.getTime()))throw new Error(`Invalid date string=${t}, expected format=yyyy-mm-dd`);return{day:i.getUTCDate(),month:i.getUTCMonth()+1,year:i.getUTCFullYear()}}function on(t){M(t.time)&&(t.time=an(t.time))}function _n(t){return{pn:0,Jv:new Map,$h:t}}function un(t){if(void 0!==t&&0!==t.length)return{Qv:t[0].rt.Eo,tm:t[t.length-1].rt.Eo}}function cn(t){let i;return t.forEach((t=>{void 0===i&&(i=t.Ho)})),r(i)}function dn(t){void 0===t.Ho&&(t.Ho=t.time)}class fn{constructor(){this.im=new Map,this.sm=new Map,this.nm=new Map,this.rm=[]}M(){this.im.clear(),this.sm.clear(),this.nm.clear(),this.rm=[]}hm(t,i){let s=0!==this.im.size,n=!1;const e=this.sm.get(t);if(void 0!==e)if(1===this.sm.size)s=!1,n=!0,this.im.clear();else for(const i of this.rm)i.pointData.Jv.delete(t)&&(n=!0);let r=[];if(0!==i.length){const s=i;s.forEach((t=>dn(t))),function(t){t.forEach(on)}(i);const e=h(hn(i)),l=Zs(t.$r());r=s.map((i=>{const s=e(i.time);let r=this.im.get(s.Eo);void 0===r&&(r=_n(s),this.im.set(s.Eo,r),n=!0);const h=l(s,r.pn,i,i.Ho);return r.Jv.set(t,h),h}))}s&&this.lm(),this.am(t,r);let l=-1;if(n){const t=[];this.im.forEach((i=>{t.push({jo:0,rt:i.$h,pointData:i,Ho:cn(i.Jv)})})),t.sort(((t,i)=>t.rt.Eo-i.rt.Eo)),l=this.om(t)}return this._m(t,l,function(t,i){const s=un(t),n=un(i);if(void 0!==s&&void 0!==n)return{Ih:s.tm>=n.tm&&s.Qv>=n.Qv}}(this.sm.get(t),e))}Qu(t){return this.hm(t,[])}um(t,i){const s=i;dn(s),on(i);const n=h(hn([i]))(i.time),e=this.nm.get(t);if(void 0!==e&&n.Eo<e.Eo)throw new Error(`Cannot update oldest data, last time=${e.Eo}, new time=${n.Eo}`);let r=this.im.get(n.Eo);const l=void 0===r;void 0===r&&(r=_n(n),this.im.set(n.Eo,r));const a=Zs(t.$r())(n,r.pn,i,s.Ho);r.Jv.set(t,a),this.dm(t,a);const o={Ih:Ys(a)};if(!l)return this._m(t,-1,o);const _={jo:0,rt:r.$h,pointData:r,Ho:cn(r.Jv)},u=ut(this.rm,_.rt.Eo,((t,i)=>t.rt.Eo<i));this.rm.splice(u,0,_);for(let t=u;t<this.rm.length;++t)pn(this.rm[t].pointData,t);return nn(this.rm,u),this._m(t,u,o)}dm(t,i){let s=this.sm.get(t);void 0===s&&(s=[],this.sm.set(t,s));const n=0!==s.length?s[s.length-1]:null;null===n||i.rt.Eo>n.rt.Eo?Ys(i)&&s.push(i):Ys(i)?s[s.length-1]=i:s.splice(-1,1),this.nm.set(t,i.rt)}am(t,i){0!==i.length?(this.sm.set(t,i.filter(Ys)),this.nm.set(t,i[i.length-1].rt)):(this.sm.delete(t),this.nm.delete(t))}lm(){for(const t of this.rm)0===t.pointData.Jv.size&&this.im.delete(t.rt.Eo)}om(t){let i=-1;for(let s=0;s<this.rm.length&&s<t.length;++s){const n=this.rm[s],e=t[s];if(n.rt.Eo!==e.rt.Eo){i=s;break}e.jo=n.jo,pn(e.pointData,s)}if(-1===i&&this.rm.length!==t.length&&(i=Math.min(this.rm.length,t.length)),-1===i)return-1;for(let s=i;s<t.length;++s)pn(t[s].pointData,s);return nn(t,i),this.rm=t,i}fm(){if(0===this.sm.size)return null;let t=0;return this.sm.forEach((i=>{0!==i.length&&(t=Math.max(t,i[i.length-1].pn))})),t}_m(t,i,s){const n={pm:new Map,bt:{T_:this.fm()}};if(-1!==i)this.sm.forEach(((i,e)=>{n.pm.set(e,{ye:i,vm:e===t?s:void 0})})),this.sm.has(t)||n.pm.set(t,{ye:[],vm:s}),n.bt.wm=this.rm,n.bt.gm=i;else{const i=this.sm.get(t);n.pm.set(t,{ye:i||[],vm:s})}return n}}function pn(t,i){t.pn=i,t.Jv.forEach((t=>{t.pn=i}))}function vn(t){return{value:t.Ct[3],time:t.Ho}}function mn(t){return{open:t.Ct[0],high:t.Ct[1],low:t.Ct[2],close:t.Ct[3],time:t.Ho}}const wn={Area:vn,Line:vn,Baseline:vn,Histogram:function(t){return{value:t.Ct[3],color:t.O,time:t.Ho}},Bar:mn,Candlestick:mn};function gn(t){return wn[t]}const bn={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:""};class Mn{constructor(t){this.Lr=t}applyOptions(t){this.Lr.zr(t)}options(){return this.Lr.V()}bm(){return this.Lr}}class Sn{constructor(t,i,s){this.Gs=t,this.Mm=i,this.Sm=s}priceFormatter(){return this.Gs.Zh()}priceToCoordinate(t){const i=this.Gs.yt();return null===i?null:this.Gs.Tt().xt(t,i.Ct)}coordinateToPrice(t){const i=this.Gs.yt();return null===i?null:this.Gs.Tt().$i(t,i.Ct)}barsInLogicalRange(t){if(null===t)return null;const i=new ts(new Gi(t.from,t.to)).Ko(),s=this.Gs._s();if(s.vi())return null;const n=s.rh(i.Hs(),1),e=s.rh(i.Us(),-1),r=h(s.sh()),l=h(s.os());if(null!==n&&null!==e&&n.pn>e.pn)return{barsBefore:t.from-r,barsAfter:l-t.to};const a={barsBefore:null===n||n.pn===r?t.from-r:n.pn-r,barsAfter:null===e||e.pn===l?l-t.to:l-e.pn};return null!==n&&null!==e&&(a.from=n.rt.Ro||n.rt.Eo,a.to=e.rt.Ro||e.rt.Eo),a}setData(t){this.Gs.$r(),this.Mm.ym(this.Gs,t)}update(t){this.Gs.$r(),this.Mm.km(this.Gs,t)}dataByIndex(t,i){const s=this.Gs._s().rh(t,i);return null===s?null:gn(this.seriesType())(s)}setMarkers(t){const i=t.map((t=>Object.assign(Object.assign({},t),{originalTime:t.time,time:ln(t.time)})));this.Gs.Vh(i)}markers(){return this.Gs.Fh().map((t=>{const{originalTime:i,time:s}=t,n=function(t,i){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&i.indexOf(n)<0&&(s[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var e=0;for(n=Object.getOwnPropertySymbols(t);e<n.length;e++)i.indexOf(n[e])<0&&Object.prototype.propertyIsEnumerable.call(t,n[e])&&(s[n[e]]=t[n[e]])}return s}(t,["originalTime","time"]);return Object.assign({time:i},n)}))}applyOptions(t){this.Gs.zr(t)}options(){return y(this.Gs.V())}priceScale(){return this.Sm.priceScale(this.Gs.Tt().il())}createPriceLine(t){const i=w(y(bn),t),s=this.Gs.zh(i);return new Mn(s)}removePriceLine(t){this.Gs.Wh(t.bm())}seriesType(){return this.Gs.$r()}}class yn extends Sn{applyOptions(t){us(t),super.applyOptions(t)}}const kn={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,drawTicks:!0,scaleMargins:{bottom:.1,top:.2}},xn={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:T,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"},Tn={width:0,height:0,layout:{background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:11,fontFamily:T},crosshair:{vertLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},horzLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},mode:1},grid:{vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},overlayPriceScales:Object.assign({},kn),leftPriceScale:Object.assign(Object.assign({},kn),{visible:!1}),rightPriceScale:Object.assign(Object.assign({},kn),{visible:!0}),timeScale:{rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0},watermark:xn,localization:{locale:ks?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:!0,mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}},Cn={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},Dn={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},Pn={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},On={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},Nn={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},Rn={color:"#26a69a",base:0},En={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};class An{constructor(t,i){this.xm=t,this.Tm=i}applyOptions(t){this.xm.jt().Nu(this.Tm,t)}options(){return this.fi().V()}width(){return Z(this.Tm)?this.xm.zv(this.Tm):0}fi(){return h(this.xm.jt().Ru(this.Tm)).Tt}}class Ln{constructor(t,i){this.Cm=new m,this.r_=new m,this.nv=new m,this.bi=t,this.La=t.bt(),this.Ov=i,this.La.j_().l(this.Dm.bind(this)),this.La.H_().l(this.Pm.bind(this)),this.Ov.uv().l(this.Om.bind(this))}M(){this.La.j_().v(this),this.La.H_().v(this),this.Ov.uv().v(this),this.Cm.M(),this.r_.M(),this.nv.M()}scrollPosition(){return this.La.N_()}scrollToPosition(t,i){i?this.La.W_(t,1e3):this.bi.xs(t)}scrollToRealTime(){this.La.z_()}getVisibleRange(){var t,i;const s=this.La.g_();return null===s?null:{from:null!==(t=s.from.Ro)&&void 0!==t?t:s.from.Eo,to:null!==(i=s.to.Ro)&&void 0!==i?i:s.to.Eo}}setVisibleRange(t){const i={from:ln(t.from),to:ln(t.to)},s=this.La.y_(i);this.bi.tc(s)}getVisibleLogicalRange(){const t=this.La.w_();return null===t?null:{from:t.Hs(),to:t.Us()}}setVisibleLogicalRange(t){e(t.from<=t.to,"The from index cannot be after the to index."),this.bi.tc(t)}resetTimeScale(){this.bi.ys()}fitContent(){this.bi.Y_()}logicalToCoordinate(t){const i=this.bi.bt();return i.vi()?null:i.Ot(t)}coordinateToLogical(t){return this.La.vi()?null:this.La.C_(t)}timeToCoordinate(t){const i=ln(t),s=this.La.nl(i,!1);return null===s?null:this.La.Ot(s)}coordinateToTime(t){var i;const s=this.bi.bt(),n=s.C_(t),e=s.Hi(n);return null===e?null:null!==(i=e.Ro)&&void 0!==i?i:e.Eo}width(){return this.Ov.Fp().At}height(){return this.Ov.Fp().Lt}subscribeVisibleTimeRangeChange(t){this.Cm.l(t)}unsubscribeVisibleTimeRangeChange(t){this.Cm.p(t)}subscribeVisibleLogicalRangeChange(t){this.r_.l(t)}unsubscribeVisibleLogicalRangeChange(t){this.r_.p(t)}subscribeSizeChange(t){this.nv.l(t)}unsubscribeSizeChange(t){this.nv.p(t)}applyOptions(t){this.La.zr(t)}options(){return y(this.La.V())}Dm(){this.Cm.g()&&this.Cm.m(this.getVisibleRange())}Pm(){this.r_.g()&&this.r_.m(this.getVisibleLogicalRange())}Om(t){this.nv.m(t.At,t.Lt)}}function In(t){if(void 0===t||"custom"===t.type)return;const i=t;void 0!==i.minMove&&void 0===i.precision&&(i.precision=function(t){if(t>=1)return 0;let i=0;for(;i<8;i++){const s=Math.round(t);if(Math.abs(s-t)<1e-8)return i;t*=10}return i}(i.minMove))}function Bn(t){return function(t){if(S(t.handleScale)){const i=t.handleScale;t.handleScale={axisDoubleClickReset:i,axisPressedMouseMove:{time:i,price:i},mouseWheel:i,pinch:i}}else if(void 0!==t.handleScale&&S(t.handleScale.axisPressedMouseMove)){const i=t.handleScale.axisPressedMouseMove;t.handleScale.axisPressedMouseMove={time:i,price:i}}const i=t.handleScroll;S(i)&&(t.handleScroll={horzTouchDrag:i,vertTouchDrag:i,mouseWheel:i,pressedMouseMove:i})}(t),t}class Vn{constructor(t,i){this.Nm=new fn,this.Rm=new Map,this.Em=new Map,this.Am=new m,this.Lm=new m;const s=void 0===i?y(Tn):w(y(Tn),Bn(i));this.xm=new Hs(t,s),this.xm.Ap().l((t=>{this.Am.g()&&this.Am.m(this.Im(t()))}),this),this.xm.Iu().l((t=>{this.Lm.g()&&this.Lm.m(this.Im(t()))}),this);const n=this.xm.jt();this.Bm=new Ln(n,this.xm.Lv())}remove(){this.xm.Ap().v(this),this.xm.Iu().v(this),this.Bm.M(),this.xm.M(),this.Rm.clear(),this.Em.clear(),this.Am.M(),this.Lm.M(),this.Nm.M()}resize(t,i,s){this.xm.Nv(t,i,s)}addAreaSeries(t={}){In(t.priceFormat);const i=w(y(En),On,t),s=this.xm.jt().Gu("Area",i),n=new Sn(s,this,this);return this.Rm.set(n,s),this.Em.set(s,n),n}addBaselineSeries(t={}){In(t.priceFormat);const i=w(y(En),y(Nn),t),s=this.xm.jt().Gu("Baseline",i),n=new Sn(s,this,this);return this.Rm.set(n,s),this.Em.set(s,n),n}addBarSeries(t={}){In(t.priceFormat);const i=w(y(En),Dn,t),s=this.xm.jt().Gu("Bar",i),n=new Sn(s,this,this);return this.Rm.set(n,s),this.Em.set(s,n),n}addCandlestickSeries(t={}){us(t),In(t.priceFormat);const i=w(y(En),Cn,t),s=this.xm.jt().Gu("Candlestick",i),n=new yn(s,this,this);return this.Rm.set(n,s),this.Em.set(s,n),n}addHistogramSeries(t={}){In(t.priceFormat);const i=w(y(En),Rn,t),s=this.xm.jt().Gu("Histogram",i),n=new Sn(s,this,this);return this.Rm.set(n,s),this.Em.set(s,n),n}addLineSeries(t={}){In(t.priceFormat);const i=w(y(En),Pn,t),s=this.xm.jt().Gu("Line",i),n=new Sn(s,this,this);return this.Rm.set(n,s),this.Em.set(s,n),n}removeSeries(t){const i=r(this.Rm.get(t)),s=this.Nm.Qu(i);this.xm.jt().Qu(i),this.Vm(s),this.Rm.delete(t),this.Em.delete(i)}ym(t,i){this.Vm(this.Nm.hm(t,i))}km(t,i){this.Vm(this.Nm.um(t,i))}subscribeClick(t){this.Am.l(t)}unsubscribeClick(t){this.Am.p(t)}subscribeCrosshairMove(t){this.Lm.l(t)}unsubscribeCrosshairMove(t){this.Lm.p(t)}priceScale(t){return new An(this.xm,t)}timeScale(){return this.Bm}applyOptions(t){this.xm.zr(Bn(t))}options(){return this.xm.V()}takeScreenshot(){return this.xm.Bv()}Vm(t){const i=this.xm.jt();i.Ku(t.bt.T_,t.bt.wm,t.bt.gm),t.pm.forEach(((t,i)=>i.Z(t.ye,t.vm))),i.P_()}Fm(t){return r(this.Em.get(t))}Im(t){const i=new Map;t.Kv.forEach(((t,s)=>{const n=gn(s.$r())(t);e(function(t){return void 0!==t.open||void 0!==t.value}(n)),i.set(this.Fm(s),n)}));const s=void 0===t.Xv?void 0:this.Fm(t.Xv);return{time:t.rt,logical:t.pn,point:t.Yv,hoveredSeries:s,hoveredMarkerId:t.Zv,seriesData:i}}}var Fn=Object.freeze({__proto__:null,version:function(){return"4.0.0-dev+202203090750"},get LineStyle(){return i},get LineType(){return t},get TrackingModeExitMode(){return ss},get CrosshairMode(){return X},get MismatchDirection(){return mi},get PriceScaleMode(){return Fi},get PriceLineSource(){return es},get LastPriceAnimationMode(){return ns},get TickMarkType(){return is},get ColorType(){return rs},isBusinessDay:cs,isUTCTimestamp:ds,createChart:function(t,i){let s;if(M(t)){const i=document.getElementById(t);e(null!==i,`Cannot find element in DOM with id=${t}`),s=i}else s=t;return new Vn(s,i)}});window.LightweightCharts=Fn}();
